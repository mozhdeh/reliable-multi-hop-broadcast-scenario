(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    342786,       8315]
NotebookOptionsPosition[    341889,       8283]
NotebookOutlinePosition[    342244,       8299]
CellTagsIndexPosition[    342201,       8296]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       " ", "topology"}], " ", "6"}], ",", " ", 
    RowBox[{"psuccess", "=", "0.5"}], ",", "0.6", ",", "0.7", ",", "0.8", ",",
     "0.9", ",", 
    RowBox[{
    "0.98", " ", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}]}], "*****)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "the", " ", "number", " ", "of", " ", "nodes", " ", "produced", " ", "in", 
    " ", "Matlab"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"M", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"W", "=", 
     RowBox[{"Import", "[", 
      RowBox[{
      "\"\<Desktop/Script_Files/Mathematica/multi-hop/second-phase/10 \
nodes/topologyfiles/density2-nodes10-R3.000000e-01-p1-#6.txt\>\"", ",", 
       "\"\<Table\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "this", " ", "newW", " ", "is", " ", "the", " ", "multiplication", " ", 
     "of", " ", "the", " ", "connectivity", " ", "matrix", " ", "to", " ", 
     "the", " ", "successful", " ", "transmission", " ", "probability", " ", 
     "between", " ", "any", " ", "arbitrary", " ", "pair", " ", "of", " ", 
     "nodes"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newW1", "=", 
     RowBox[{"W", "*", "0.5"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newW2", "=", 
     RowBox[{"W", "*", "0.6"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newW3", "=", 
     RowBox[{"W", "*", "0.7"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newW4", "=", 
     RowBox[{"W", "*", "0.8"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newW5", "=", 
     RowBox[{"W", "*", "0.9"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newW6", "=", 
     RowBox[{"W", "*", "0.98"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"to", " ", "present", " ", "the", " ", "graph"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"W1", "=", 
     RowBox[{"AdjacencyGraph", "[", 
      RowBox[{"W", ",", 
       RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FindIndependentVertexSet", "[", "W1", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"HighlightGraph", "[", 
        RowBox[{"W1", ",", "%", ",", 
         RowBox[{"GraphHighlightStyle", "\[Rule]", "\"\<Thick\>\""}]}], "]"}],
        "\[IndentingNewLine]", "A"}], "=", 
      RowBox[{
       RowBox[{"FindIndependentVertexSet", "[", 
        RowBox[{"W1", ",", "Infinity", ",", "All"}], "]"}], "//", 
       RowBox[{"Short", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<The independent vertex sets are: \>\"", ",", "A"}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Length", "[", 
      RowBox[{"A", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Needs", "[", "\"\<GraphUtilities`\>\"", "]"}], 
     "\[IndentingNewLine]", 
     RowBox[{"GraphEdit", "[", "W1", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", 
       RowBox[{"M", "+", "1"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{"M", "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "\[Equal]", "j"}], ",", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"W", ",", "i", ",", "j"}], "]"}], "=", "0"}]}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "defines", " ", "initial", " ", "state", " ", "probability", " ", 
     RowBox[{"vector", ":", " ", 
      RowBox[{
      "we", " ", "always", " ", "start", " ", "with", " ", "M", " ", 
       "stations", " ", "not", " ", "having", " ", "the", " ", "packet", " ", 
       "of", " ", "interest"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h0", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "M"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Part", "[", 
      RowBox[{"h0", ",", "1"}], "]"}], "=", "1"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<vector h0: \>\"", ",", 
       RowBox[{"TableForm", "[", "h0", "]"}]}], "]"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "defines", " ", "the", " ", "second", " ", "state", " ", "probability", 
     " ", 
     RowBox[{"vector", ":", " ", 
      RowBox[{"after", " ", "the", " ", "original", " ", "broadcast"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h1", " ", "=", " ", 
     RowBox[{"h0", " ", ".", "newW1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Part", "[", 
      RowBox[{"h1", ",", "1"}], "]"}], "=", "1"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h2", " ", "=", " ", 
     RowBox[{"h0", " ", ".", "newW2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Part", "[", 
      RowBox[{"h2", ",", "1"}], "]"}], "=", "1"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h3", " ", "=", " ", 
     RowBox[{"h0", " ", ".", "newW3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Part", "[", 
      RowBox[{"h3", ",", "1"}], "]"}], "=", "1"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h4", " ", "=", " ", 
     RowBox[{"h0", " ", ".", "newW4"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Part", "[", 
      RowBox[{"h4", ",", "1"}], "]"}], "=", "1"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h5", " ", "=", " ", 
     RowBox[{"h0", " ", ".", "newW5"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Part", "[", 
      RowBox[{"h5", ",", "1"}], "]"}], "=", "1"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h6", " ", "=", " ", 
     RowBox[{"h0", " ", ".", "newW6"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Part", "[", 
      RowBox[{"h6", ",", "1"}], "]"}], "=", "1"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "it", " ", "is", " ", "not", " ", "possible", " ", "to", " ", "find", 
      " ", "the", " ", "state", " ", "probability", " ", "vectors", " ", 
      "for", " ", "the", " ", "subsequent", " ", "rebroadcast", " ", "steps", 
      " ", "just", " ", "by", " ", "multiplying", " ", "the", " ", "previous",
       " ", "state", " ", "vector", " ", "to", " ", "the", " ", "transition", 
      " ", "probability", " ", "matrix"}], ",", " ", 
     RowBox[{
      RowBox[{
      "as", " ", "it", " ", "is", " ", "not", " ", "any", " ", "longer", " ", 
       "just", " ", "the", " ", "source", " ", "sending", " ", "the", " ", 
       "packet"}], ";", " ", "so"}], ",", " ", 
     RowBox[{
     "the", " ", "following", " ", "recursive", " ", "function", " ", "aims", 
      " ", "to", " ", "generalizing", " ", "the", " ", "probability", " ", 
      "distribution", " ", "for", " ", "the", " ", "arbitrary", " ", "node", 
      " ", "\"\<x\>\"", " ", "to", " ", "have", " ", "the", " ", "packet", 
      " ", "the", " ", "the", " ", "arbitrary", " ", "rebroadcast", " ", 
      "step", " ", "\"\<n\>\""}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "the", " ", "number", " ", "of", " ", "rebroadcast", " ", "steps", " ", 
     "allowed"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "  ", 
   RowBox[{
    RowBox[{"Z", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "a", " ", "matrix", " ", "to", " ", "store", " ", "probabilities", " ", 
     "computed", " ", "from", " ", "the", " ", "recursive", " ", "function"}],
     " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"probability", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n", "*", "k"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "M"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "Z"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Matrix probability: \>\"", ",", 
       RowBox[{"TableForm", "[", "probability", "]"}]}], "]"}], ";"}], "*)"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "P1", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P1", "[", 
      RowBox[{"1", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h1", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P1", "[", 
      RowBox[{"2", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h1", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P1", "[", 
      RowBox[{"3", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h1", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P1", "[", 
      RowBox[{"4", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h1", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P1", "[", 
      RowBox[{"5", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h1", ",", "5"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P1", "[", 
      RowBox[{"6", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h1", ",", "6"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P1", "[", 
      RowBox[{"7", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h1", ",", "7"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P1", "[", 
      RowBox[{"8", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h1", ",", "8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P1", "[", 
      RowBox[{"9", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h1", ",", "9"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P1", "[", 
      RowBox[{"10", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h1", ",", "10"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "P2", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P2", "[", 
      RowBox[{"1", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h2", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P2", "[", 
      RowBox[{"2", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h2", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P2", "[", 
      RowBox[{"3", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h2", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P2", "[", 
      RowBox[{"4", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h2", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P2", "[", 
      RowBox[{"5", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h2", ",", "5"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P2", "[", 
      RowBox[{"6", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h2", ",", "6"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P2", "[", 
      RowBox[{"7", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h2", ",", "7"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P2", "[", 
      RowBox[{"8", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h2", ",", "8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P2", "[", 
      RowBox[{"9", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h2", ",", "9"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P2", "[", 
      RowBox[{"10", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h2", ",", "10"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "P3", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P3", "[", 
      RowBox[{"1", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h3", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P3", "[", 
      RowBox[{"2", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h3", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P3", "[", 
      RowBox[{"3", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h3", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P3", "[", 
      RowBox[{"4", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h3", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P3", "[", 
      RowBox[{"5", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h3", ",", "5"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P3", "[", 
      RowBox[{"6", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h3", ",", "6"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P3", "[", 
      RowBox[{"7", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h3", ",", "7"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P3", "[", 
      RowBox[{"8", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h3", ",", "8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P3", "[", 
      RowBox[{"9", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h3", ",", "9"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P3", "[", 
      RowBox[{"10", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h3", ",", "10"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "P4", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P4", "[", 
      RowBox[{"1", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h4", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P4", "[", 
      RowBox[{"2", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h4", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P4", "[", 
      RowBox[{"3", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h4", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P4", "[", 
      RowBox[{"4", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h4", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P4", "[", 
      RowBox[{"5", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h4", ",", "5"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P4", "[", 
      RowBox[{"6", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h4", ",", "6"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P4", "[", 
      RowBox[{"7", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h4", ",", "7"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P4", "[", 
      RowBox[{"8", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h4", ",", "8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P4", "[", 
      RowBox[{"9", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h4", ",", "9"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P4", "[", 
      RowBox[{"10", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h4", ",", "10"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "P5", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P5", "[", 
      RowBox[{"1", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h5", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P5", "[", 
      RowBox[{"2", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h5", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P5", "[", 
      RowBox[{"3", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h5", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P5", "[", 
      RowBox[{"4", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h5", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P5", "[", 
      RowBox[{"5", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h5", ",", "5"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P5", "[", 
      RowBox[{"6", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h5", ",", "6"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P5", "[", 
      RowBox[{"7", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h5", ",", "7"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P5", "[", 
      RowBox[{"8", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h5", ",", "8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P5", "[", 
      RowBox[{"9", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h5", ",", "9"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P5", "[", 
      RowBox[{"10", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h5", ",", "10"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "P6", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P6", "[", 
      RowBox[{"1", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h6", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P6", "[", 
      RowBox[{"2", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h6", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P6", "[", 
      RowBox[{"3", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h6", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P6", "[", 
      RowBox[{"4", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h6", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P6", "[", 
      RowBox[{"5", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h6", ",", "5"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P6", "[", 
      RowBox[{"6", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h6", ",", "6"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P6", "[", 
      RowBox[{"7", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h6", ",", "7"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P6", "[", 
      RowBox[{"8", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h6", ",", "8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P6", "[", 
      RowBox[{"9", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h6", ",", "9"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P6", "[", 
      RowBox[{"10", ",", "0"}], "]"}], "=", 
     RowBox[{"Part", "[", 
      RowBox[{"h6", ",", "10"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"manual", "-", "end"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P1", "[", 
      RowBox[{"x_", ",", "n_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"P1", "[", 
       RowBox[{"x", ",", "n"}], "]"}], "=", 
      RowBox[{
       RowBox[{"P1", "[", 
        RowBox[{"x", ",", 
         RowBox[{"n", "-", "1"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"P1", "[", 
           RowBox[{"x", ",", 
            RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"n", "\[Equal]", "1"}], ",", 
                 RowBox[{"P1", "[", 
                  RowBox[{"y", ",", 
                   RowBox[{"n", "-", "1"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"P1", "[", 
                   RowBox[{"y", ",", 
                    RowBox[{"n", "-", "1"}]}], "]"}], "-", 
                  RowBox[{"P1", "[", 
                   RowBox[{"y", ",", 
                    RowBox[{"n", "-", "2"}]}], "]"}]}]}], "]"}], "*", 
               RowBox[{"Part", "[", 
                RowBox[{"newW1", ",", "y", ",", "x"}], "]"}]}], ")"}]}], ",", 
            
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"Complement", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", "M"}], "]"}], ",", 
                RowBox[{"{", "1", "}"}], ",", 
                RowBox[{"{", "x", "}"}]}], "]"}]}], "}"}]}], "]"}]}], 
         ")"}]}]}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "taking", " ", "AVG", " ", "over", " ", "probabilities", " ", "for", " ",
       "a", " ", "certain", " ", "number", " ", "of", " ", "nodes", " ", 
      "and", " ", "number", " ", "of", " ", "rebroadcst", " ", 
      RowBox[{"steps", ".", " ", "First"}]}], ",", " ", 
     RowBox[{
     "we", " ", "need", " ", "to", " ", "define", " ", "a", " ", "vector", 
      " ", "to", " ", "save", " ", "the", " ", "averages"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AVG1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "Z"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{"Z", "+", "1"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"AVG1", ",", "n"}], "]"}], "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"P1", "[", 
            RowBox[{"x", ",", "n"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{"M", "-", "1"}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "2", ",", "M"}], "}"}]}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P2", "[", 
      RowBox[{"x_", ",", "n_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"P2", "[", 
       RowBox[{"x", ",", "n"}], "]"}], "=", 
      RowBox[{
       RowBox[{"P2", "[", 
        RowBox[{"x", ",", 
         RowBox[{"n", "-", "1"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"P2", "[", 
           RowBox[{"x", ",", 
            RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"n", "\[Equal]", "1"}], ",", 
                 RowBox[{"P2", "[", 
                  RowBox[{"y", ",", 
                   RowBox[{"n", "-", "1"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"P2", "[", 
                   RowBox[{"y", ",", 
                    RowBox[{"n", "-", "1"}]}], "]"}], "-", 
                  RowBox[{"P2", "[", 
                   RowBox[{"y", ",", 
                    RowBox[{"n", "-", "2"}]}], "]"}]}]}], "]"}], "*", 
               RowBox[{"Part", "[", 
                RowBox[{"newW2", ",", "y", ",", "x"}], "]"}]}], ")"}]}], ",", 
            
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"Complement", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", "M"}], "]"}], ",", 
                RowBox[{"{", "1", "}"}], ",", 
                RowBox[{"{", "x", "}"}]}], "]"}]}], "}"}]}], "]"}]}], 
         ")"}]}]}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "taking", " ", "AVG", " ", "over", " ", "probabilities", " ", "for", " ",
       "a", " ", "certain", " ", "number", " ", "of", " ", "nodes", " ", 
      "and", " ", "number", " ", "of", " ", "rebroadcst", " ", 
      RowBox[{"steps", ".", " ", "First"}]}], ",", " ", 
     RowBox[{
     "we", " ", "need", " ", "to", " ", "define", " ", "a", " ", "vector", 
      " ", "to", " ", "save", " ", "the", " ", "averages"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AVG2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "Z"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{"Z", "+", "1"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"AVG2", ",", "n"}], "]"}], "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"P2", "[", 
            RowBox[{"x", ",", "n"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{"M", "-", "1"}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "2", ",", "M"}], "}"}]}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P3", "[", 
      RowBox[{"x_", ",", "n_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"P3", "[", 
       RowBox[{"x", ",", "n"}], "]"}], "=", 
      RowBox[{
       RowBox[{"P3", "[", 
        RowBox[{"x", ",", 
         RowBox[{"n", "-", "1"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"P3", "[", 
           RowBox[{"x", ",", 
            RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"n", "\[Equal]", "1"}], ",", 
                 RowBox[{"P3", "[", 
                  RowBox[{"y", ",", 
                   RowBox[{"n", "-", "1"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"P3", "[", 
                   RowBox[{"y", ",", 
                    RowBox[{"n", "-", "1"}]}], "]"}], "-", 
                  RowBox[{"P3", "[", 
                   RowBox[{"y", ",", 
                    RowBox[{"n", "-", "2"}]}], "]"}]}]}], "]"}], "*", 
               RowBox[{"Part", "[", 
                RowBox[{"newW3", ",", "y", ",", "x"}], "]"}]}], ")"}]}], ",", 
            
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"Complement", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", "M"}], "]"}], ",", 
                RowBox[{"{", "1", "}"}], ",", 
                RowBox[{"{", "x", "}"}]}], "]"}]}], "}"}]}], "]"}]}], 
         ")"}]}]}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "taking", " ", "AVG", " ", "over", " ", "probabilities", " ", "for", " ",
       "a", " ", "certain", " ", "number", " ", "of", " ", "nodes", " ", 
      "and", " ", "number", " ", "of", " ", "rebroadcst", " ", 
      RowBox[{"steps", ".", " ", "First"}]}], ",", " ", 
     RowBox[{
     "we", " ", "need", " ", "to", " ", "define", " ", "a", " ", "vector", 
      " ", "to", " ", "save", " ", "the", " ", "averages"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AVG3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "Z"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{"Z", "+", "1"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"AVG3", ",", "n"}], "]"}], "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"P3", "[", 
            RowBox[{"x", ",", "n"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{"M", "-", "1"}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "2", ",", "M"}], "}"}]}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P4", "[", 
      RowBox[{"x_", ",", "n_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"P4", "[", 
       RowBox[{"x", ",", "n"}], "]"}], "=", 
      RowBox[{
       RowBox[{"P4", "[", 
        RowBox[{"x", ",", 
         RowBox[{"n", "-", "1"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"P4", "[", 
           RowBox[{"x", ",", 
            RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"n", "\[Equal]", "1"}], ",", 
                 RowBox[{"P4", "[", 
                  RowBox[{"y", ",", 
                   RowBox[{"n", "-", "1"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"P4", "[", 
                   RowBox[{"y", ",", 
                    RowBox[{"n", "-", "1"}]}], "]"}], "-", 
                  RowBox[{"P4", "[", 
                   RowBox[{"y", ",", 
                    RowBox[{"n", "-", "2"}]}], "]"}]}]}], "]"}], "*", 
               RowBox[{"Part", "[", 
                RowBox[{"newW4", ",", "y", ",", "x"}], "]"}]}], ")"}]}], ",", 
            
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"Complement", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", "M"}], "]"}], ",", 
                RowBox[{"{", "1", "}"}], ",", 
                RowBox[{"{", "x", "}"}]}], "]"}]}], "}"}]}], "]"}]}], 
         ")"}]}]}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "taking", " ", "AVG", " ", "over", " ", "probabilities", " ", "for", " ",
       "a", " ", "certain", " ", "number", " ", "of", " ", "nodes", " ", 
      "and", " ", "number", " ", "of", " ", "rebroadcst", " ", 
      RowBox[{"steps", ".", " ", "First"}]}], ",", " ", 
     RowBox[{
     "we", " ", "need", " ", "to", " ", "define", " ", "a", " ", "vector", 
      " ", "to", " ", "save", " ", "the", " ", "averages"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AVG4", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "Z"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{"Z", "+", "1"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"AVG4", ",", "n"}], "]"}], "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"P4", "[", 
            RowBox[{"x", ",", "n"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{"M", "-", "1"}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "2", ",", "M"}], "}"}]}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P5", "[", 
      RowBox[{"x_", ",", "n_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"P5", "[", 
       RowBox[{"x", ",", "n"}], "]"}], "=", 
      RowBox[{
       RowBox[{"P5", "[", 
        RowBox[{"x", ",", 
         RowBox[{"n", "-", "1"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"P5", "[", 
           RowBox[{"x", ",", 
            RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"n", "\[Equal]", "1"}], ",", 
                 RowBox[{"P5", "[", 
                  RowBox[{"y", ",", 
                   RowBox[{"n", "-", "1"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"P5", "[", 
                   RowBox[{"y", ",", 
                    RowBox[{"n", "-", "1"}]}], "]"}], "-", 
                  RowBox[{"P5", "[", 
                   RowBox[{"y", ",", 
                    RowBox[{"n", "-", "2"}]}], "]"}]}]}], "]"}], "*", 
               RowBox[{"Part", "[", 
                RowBox[{"newW5", ",", "y", ",", "x"}], "]"}]}], ")"}]}], ",", 
            
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"Complement", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", "M"}], "]"}], ",", 
                RowBox[{"{", "1", "}"}], ",", 
                RowBox[{"{", "x", "}"}]}], "]"}]}], "}"}]}], "]"}]}], 
         ")"}]}]}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "taking", " ", "AVG", " ", "over", " ", "probabilities", " ", "for", " ",
       "a", " ", "certain", " ", "number", " ", "of", " ", "nodes", " ", 
      "and", " ", "number", " ", "of", " ", "rebroadcst", " ", 
      RowBox[{"steps", ".", " ", "First"}]}], ",", " ", 
     RowBox[{
     "we", " ", "need", " ", "to", " ", "define", " ", "a", " ", "vector", 
      " ", "to", " ", "save", " ", "the", " ", "averages"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AVG5", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "Z"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{"Z", "+", "1"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"AVG5", ",", "n"}], "]"}], "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"P5", "[", 
            RowBox[{"x", ",", "n"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{"M", "-", "1"}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "2", ",", "M"}], "}"}]}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P6", "[", 
      RowBox[{"x_", ",", "n_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"P6", "[", 
       RowBox[{"x", ",", "n"}], "]"}], "=", 
      RowBox[{
       RowBox[{"P6", "[", 
        RowBox[{"x", ",", 
         RowBox[{"n", "-", "1"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"P6", "[", 
           RowBox[{"x", ",", 
            RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"n", "\[Equal]", "1"}], ",", 
                 RowBox[{"P6", "[", 
                  RowBox[{"y", ",", 
                   RowBox[{"n", "-", "1"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"P6", "[", 
                   RowBox[{"y", ",", 
                    RowBox[{"n", "-", "1"}]}], "]"}], "-", 
                  RowBox[{"P6", "[", 
                   RowBox[{"y", ",", 
                    RowBox[{"n", "-", "2"}]}], "]"}]}]}], "]"}], "*", 
               RowBox[{"Part", "[", 
                RowBox[{"newW6", ",", "y", ",", "x"}], "]"}]}], ")"}]}], ",", 
            
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"Complement", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", "M"}], "]"}], ",", 
                RowBox[{"{", "1", "}"}], ",", 
                RowBox[{"{", "x", "}"}]}], "]"}]}], "}"}]}], "]"}]}], 
         ")"}]}]}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "taking", " ", "AVG", " ", "over", " ", "probabilities", " ", "for", " ",
       "a", " ", "certain", " ", "number", " ", "of", " ", "nodes", " ", 
      "and", " ", "number", " ", "of", " ", "rebroadcst", " ", 
      RowBox[{"steps", ".", " ", "First"}]}], ",", " ", 
     RowBox[{
     "we", " ", "need", " ", "to", " ", "define", " ", "a", " ", "vector", 
      " ", "to", " ", "save", " ", "the", " ", "averages"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AVG6", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "Z"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{"Z", "+", "1"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"AVG6", ",", "n"}], "]"}], "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"P6", "[", 
            RowBox[{"x", ",", "n"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{"M", "-", "1"}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "2", ",", "M"}], "}"}]}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "The", " ", "number", " ", "of", " ", "binary", " ", "combinations", " ",
       "of", " ", "M"}], "=", 
     RowBox[{"5", " ", "nodes"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bin", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", "^", "M"}], ")"}], "/", "2"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "An", " ", "Array", " ", "to", " ", "store", " ", "all", " ", "binary", 
      " ", "states", " ", "after", " ", "the", " ", "end", " ", "of", " ", 
      "the", " ", "multi"}], "-", 
     RowBox[{"hop", " ", "broadcast"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"statesArray1", "=", 
     RowBox[{"Tuples", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", "M"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<The initial statesArray1 is: \>\"", ",", "statesArray1"}], 
      "]"}], ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"statesArray2", "=", 
     RowBox[{"Drop", "[", 
      RowBox[{"statesArray1", ",", "bin"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "save", " ", "the", " ", "positions", " ", "of", " ", "zeros", " ", 
       "and", " ", "ones", " ", "of", " ", "each", " ", "state", " ", "into", 
       " ", "the", " ", "relevant", " ", "rep", " ", "and", " ", "req", " ", 
       "vectors"}], ";", " ", "Also"}], ",", " ", 
     RowBox[{
     "save", " ", "all", " ", "the", " ", "subsets", " ", "of", " ", 
      "potential", " ", "repliers", " ", "for", " ", "each", " ", "state", 
      " ", "\"\<i\>\""}], ",", " ", 
     RowBox[{"in", " ", "its", " ", "relevant", " ", 
      RowBox[{"Subscript", "[", 
       RowBox[{"myAllsets", ",", "i"}], "]"}], " ", "vector"}]}], " ", "*)"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Finding", " ", "all", " ", "subsets", " ", "of", " ", "the", " ", 
       "vector", " ", "\"\<req_i\>\"", " ", "and", " ", "then", " ", "choose",
        " ", "the", " ", "subsets", " ", "that", " ", "are", " ", "indeed", 
       " ", "independent", " ", "sets"}], ";", " ", 
      RowBox[{
      "each", " ", "of", " ", "these", " ", "independet", " ", "sets", " ", 
       "are", " ", "indeed", " ", "the", " ", "set", " ", "of", " ", "out", 
       " ", "of", " ", "range", " ", "nodes", " ", "that", " ", "are", " ", 
       "missing", " ", "the", " ", "packet"}]}], ",", " ", 
     RowBox[{
     "so", " ", "they", " ", "all", " ", "may", " ", "issue", " ", "a", " ", 
      "request", " ", "for", " ", "the", " ", "same", " ", "packet"}], ",", 
     " ", 
     RowBox[{
      RowBox[{"as", " ", "they", " ", 
       RowBox[{"don", "'"}], "t", " ", "hear", " ", "each", " ", "other"}], 
      ";", " ", "Accordignly"}], ",", " ", 
     RowBox[{
     "the", " ", "first", " ", "summation", " ", "term", " ", "in", " ", 
      "\"\<q_ij\>\""}], ",", " ", 
     RowBox[{
     "is", " ", "to", " ", "be", " ", "considering", " ", "either", " ", "of",
       " ", "these", " ", "independent", " ", "sets", " ", "of", " ", 
      "requesting", " ", "nodes"}], ",", " ", 
     RowBox[{
     "as", " ", "the", " ", "nodes", " ", "requesting", " ", "the", " ", 
      "same", " ", "packet"}], ",", " ", "concurrently"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", 
       RowBox[{"bin", "+", "1"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"rep", ",", "i"}], "]"}], "=", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"statesArray2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", ">", "0"}], "&"}], ")"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"H", ",", "i"}], "]"}], "=", 
        RowBox[{"Length", "[", 
         RowBox[{"Subscript", "[", 
          RowBox[{"rep", ",", "i"}], "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"req", ",", "i"}], "]"}], "=", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"statesArray2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "<", "1"}], "&"}], ")"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"F", ",", "i"}], "]"}], "=", 
        RowBox[{"Length", "[", 
         RowBox[{"Subscript", "[", 
          RowBox[{"req", ",", "i"}], "]"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "we", " ", "need", " ", "to", " ", "remove", " ", "the", " ", "states", 
       " ", "that", " ", "are", " ", "not", " ", "topologically", " ", 
       "possible", " ", "to", " ", "happen"}], ";", " ", 
      RowBox[{"for", " ", "example"}]}], ",", " ", 
     RowBox[{"if", " ", "req_i:", " ", "2"}], ",", 
     RowBox[{
      RowBox[{"4", " ", "&"}], " ", "rep_i:", "1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
       "3", " ", "and", " ", "there", " ", "is", " ", "no", " ", "direct", 
        " ", "connection", " ", "between", " ", "1"}], " ", "&"}], " ", "3"}],
      ",", " ", 
     RowBox[{
     "such", " ", "a", " ", "state", " ", "is", " ", "not", " ", "possible", 
      " ", "to", " ", "happen", " ", "and", " ", "must", " ", "be", " ", 
      "removed", " ", "from", " ", "the", " ", "list", " ", "of", " ", "all", 
      " ", "states", " ", "as", " ", "follows"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "2"}], ",", 
      RowBox[{"i", "<", 
       RowBox[{
        RowBox[{"Length", "[", "statesArray2", "]"}], "+", "1"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "2"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Subscript", "[", 
             RowBox[{"rep", ",", "i"}], "]"}], "]"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"repneigh", ",", "i", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"rep", ",", "i"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "=", 
           RowBox[{"AdjacencyList", "[", 
            RowBox[{"W1", ",", 
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"rep", ",", "i"}], "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"x", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "<", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Subscript", "[", 
                RowBox[{"repneigh", ",", "i", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "i"}], "]"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", 
              "1"}]}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"Subscript", "[", 
                  RowBox[{"rep", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{"repneigh", ",", "i", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "i"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "}"}]}], "]"}], ",", 
               RowBox[{"Break", "[", "]"}], ",", 
               RowBox[{"x", "=", 
                RowBox[{"x", "+", "1"}]}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"x", "==", 
             RowBox[{"Length", "[", 
              RowBox[{"Subscript", "[", 
               RowBox[{"repneigh", ",", "i", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Subscript", "[", 
                   RowBox[{"rep", ",", "i"}], "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"statesArray2", "=", 
               RowBox[{"ReplacePart", "[", 
                RowBox[{"statesArray2", ",", 
                 RowBox[{"i", "\[Rule]", "0"}]}], "]"}]}], ";", 
              RowBox[{"Break", "[", "]"}]}], ")"}], ",", 
            RowBox[{"Unevaluated", "[", 
             RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "now", " ", "removing", " ", "the", " ", "zeros", " ", "from", " ", "the",
      " ", "set", " ", "of", " ", "all", " ", "states"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"statesArray2", "=", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{"statesArray2", ",", "0"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"statesArray2", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"statesArray2", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", 
       RowBox[{
        RowBox[{"Length", "[", "statesArray2", "]"}], "+", "1"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"rep", ",", "i"}], "]"}], "=", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"statesArray2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", ">", "0"}], "&"}], ")"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"H", ",", "i"}], "]"}], "=", 
        RowBox[{"Length", "[", 
         RowBox[{"Subscript", "[", 
          RowBox[{"rep", ",", "i"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"req", ",", "i"}], "]"}], "=", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"statesArray2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "<", "1"}], "&"}], ")"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"F", ",", "i"}], "]"}], "=", 
        RowBox[{"Length", "[", 
         RowBox[{"Subscript", "[", 
          RowBox[{"req", ",", "i"}], "]"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "an", " ", "array", " ", "to", " ", "store", " ", "the", " ", "PMF", " ",
       "values", " ", "for", " ", "psuccess"}], "=", "0.5"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"singlePMFArray1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "g", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"g", ",", "1", ",", "2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "an", " ", "array", " ", "to", " ", "store", " ", "the", " ", "CDF", " ",
       "values", " ", "for", " ", "psuccess"}], "=", "0.5"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"singleCDFArray1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "g", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"g", ",", "1", ",", "2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "an", " ", "array", " ", "to", " ", "store", " ", "the", " ", "PMF", " ",
       "values", " ", "for", " ", "psuccess"}], "=", "0.6"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"singlePMFArray2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "g", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"g", ",", "1", ",", "2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "an", " ", "array", " ", "to", " ", "store", " ", "the", " ", "CDF", " ",
       "values", " ", "for", " ", "psuccess"}], "=", "0.6"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"singleCDFArray2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "g", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"g", ",", "1", ",", "2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "an", " ", "array", " ", "to", " ", "store", " ", "the", " ", "PMF", " ",
       "values", " ", "for", " ", "psuccess"}], "=", "0.7"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"singlePMFArray3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "g", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"g", ",", "1", ",", "2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "an", " ", "array", " ", "to", " ", "store", " ", "the", " ", "CDF", " ",
       "values", " ", "for", " ", "psuccess"}], "=", "0.7"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"singleCDFArray3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "g", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"g", ",", "1", ",", "2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "an", " ", "array", " ", "to", " ", "store", " ", "the", " ", "PMF", " ",
       "values", " ", "for", " ", "psuccess"}], "=", "0.8"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"singlePMFArray4", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "g", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"g", ",", "1", ",", "2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "an", " ", "array", " ", "to", " ", "store", " ", "the", " ", "CDF", " ",
       "values", " ", "for", " ", "psuccess"}], "=", "0.8"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"singleCDFArray4", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "g", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"g", ",", "1", ",", "2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "an", " ", "array", " ", "to", " ", "store", " ", "the", " ", "PMF", " ",
       "values", " ", "for", " ", "psuccess"}], "=", "0.9"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"singlePMFArray5", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "g", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"g", ",", "1", ",", "2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "an", " ", "array", " ", "to", " ", "store", " ", "the", " ", "CDF", " ",
       "values", " ", "for", " ", "psuccess"}], "=", "0.9"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"singleCDFArray5", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "g", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"g", ",", "1", ",", "2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "an", " ", "array", " ", "to", " ", "store", " ", "the", " ", "PMF", " ",
       "values", " ", "for", " ", "psuccess"}], "=", "0.98"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"singlePMFArray6", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "g", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"g", ",", "1", ",", "2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "an", " ", "array", " ", "to", " ", "store", " ", "the", " ", "CDF", " ",
       "values", " ", "for", " ", "psuccess"}], "=", "0.98"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"singleCDFArray6", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "g", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"g", ",", "1", ",", "2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Defining", " ", "the", " ", "Hamming", " ", "distance", " ", "between",
        " ", "two", " ", "arbitrary", " ", "states", " ", "n"}], " ", "&"}], 
     " ", "k", " ", "for", " ", "ease", " ", "of", " ", "later", " ", "usage",
      " ", "in", " ", "the", " ", "script"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HD", "[", 
      RowBox[{"n_", ",", "k_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"HD", "[", 
       RowBox[{"n", ",", "k"}], "]"}], "=", 
      RowBox[{"HammingDistance", "[", 
       RowBox[{
        RowBox[{"statesArray2", "[", 
         RowBox[{"[", "n", "]"}], "]"}], ",", 
        RowBox[{"statesArray2", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Defining", " ", "the", " ", "vector", " ", "Hamming", " ", "distance"}],
      ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
        "containing", " ", "the", " ", "positions", " ", "of", " ", "non"}], 
        "-", 
        RowBox[{
        "matching", " ", "elements", " ", "of", " ", "two", " ", "vectors", 
         " ", "\"\<n\>\""}]}], " ", "&"}], " ", "\"\<k\>\""}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{"v", ",", "n_", ",", "k_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"v", ",", "n", ",", "k"}], "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"statesArray2", "[", 
             RowBox[{"[", "n", "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "!=", 
           RowBox[{
            RowBox[{"statesArray2", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", "i", ",", 
          RowBox[{"Unevaluated", "[", 
           RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "M"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Defining", " ", "a", " ", "function", " ", "to", " ", 
      RowBox[{"form", "/", "save"}], " ", "the", " ", "complement", " ", "of",
       " ", "\"\<Subscript[v,n_,k_]\>\""}], ",", " ", 
     RowBox[{"relative", " ", "to", " ", "\"\<req_{n}\>\""}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"compv", ",", "n_", ",", "k_"}], "]"}], ":=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"req", ",", "n"}], "]"}], ",", 
        RowBox[{"List", "[", 
         RowBox[{"Subscript", "[", 
          RowBox[{"v", ",", "n", ",", "k"}], "]"}], "]"}]}], "]"}]}], ";"}], 
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{"compv", ",", "n_", ",", "k_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"compv", ",", "n", ",", "k"}], "]"}], "=", 
      RowBox[{"Subscript", "[", 
       RowBox[{"req", ",", "k"}], "]"}]}]}], ";"}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "creating", " ", "all", " ", "the", " ", "maximum", " ", "independent", 
      " ", "subsets", " ", "of", " ", "\"\<req_i\>\""}], ",", " ", 
     RowBox[{
     "as", " ", "the", " ", "samples", " ", "of", " ", "the", " ", "random", 
      " ", "variable", " ", "\"\<A\>\"", " ", "in", " ", "the", " ", "chain", 
      " ", "rule", " ", "probability", " ", "formula"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"A", ",", "i"}], "]"}], "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"FindIndependentVertexSet", "[", 
          RowBox[{
           RowBox[{"Subgraph", "[", 
            RowBox[{"W1", ",", 
             RowBox[{"Subscript", "[", 
              RowBox[{"req", ",", "i"}], "]"}], ",", 
             RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{"FindIndependentVertexSet", "[", 
               RowBox[{"Subgraph", "[", 
                RowBox[{"W1", ",", 
                 RowBox[{"Subscript", "[", 
                  RowBox[{"req", ",", "i"}], "]"}]}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "}"}], ",", "All"}], 
          "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "nested", " ", "\"\<for\>\"", " ", "loop", " ", "saves", 
      " ", "every", " ", "element", " ", "of", " ", "every", " ", "A_", 
      RowBox[{"{", "i", "}"}]}], ",", " ", 
     RowBox[{
      RowBox[{"in", " ", "a", " ", "separate", " ", "vector", " ", "a_", 
       RowBox[{"{", 
        RowBox[{"i", ",", "g"}], "}"}]}], ";", " ", "so"}], ",", " ", 
     RowBox[{"as", " ", "a", " ", "result"}], ",", " ", 
     RowBox[{
      RowBox[{"each", " ", "A_", 
       RowBox[{"{", "i", "}"}], " ", "with", " ", "g"}], "=", "1"}], ",", "2",
      ",", "...", ",", 
     RowBox[{
      RowBox[{"length", "[", 
       RowBox[{"A_", 
        RowBox[{"{", "i", "}"}]}], "]"}], " ", "elements"}], ",", " ", 
     RowBox[{
      RowBox[{"will", " ", "have", " ", "g"}], "=", "1"}], ",", "2", ",", "...",
      ",", 
     RowBox[{"length", "[", 
      RowBox[{"A_", 
       RowBox[{"{", "i", "}"}]}], "]"}], ",", " ", 
     RowBox[{"a_", 
      RowBox[{"{", 
       RowBox[{"i", ",", "g"}], "}"}], " ", "vectors"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"g", "=", "1"}], ",", 
         RowBox[{"g", "<", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Subscript", "[", 
             RowBox[{"A", ",", "i"}], "]"}], "]"}], "+", "1"}]}], ",", 
         RowBox[{"g", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"a", ",", "i", ",", "g"}], "]"}], "=", 
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"A", ",", "i"}], "]"}], "[", 
            RowBox[{"[", "g", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "forming", " ", "all", " ", "possible", " ", "subsets", " ", "of", " ", 
      "\"\<rep_i\>\""}], ",", " ", 
     RowBox[{
     "as", " ", "the", " ", "instances", " ", "of", " ", "the", " ", "random",
       " ", "variable", " ", "\"\<B\>\"", " ", "in", " ", "the", " ", 
      "formula", " ", "for", " ", "bayesian", " ", "chain", " ", "rule"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"B", ",", "i"}], "]"}], "=", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"Subsets", "[", 
           RowBox[{"Subscript", "[", 
            RowBox[{"rep", ",", "i"}], "]"}], "]"}], ",", "1"}], "]"}]}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "nested", " ", "\"\<for\>\"", " ", "loop", " ", "saves", 
      " ", "every", " ", "element", " ", "of", " ", "every", " ", "B_", 
      RowBox[{"{", "i", "}"}]}], ",", " ", 
     RowBox[{
      RowBox[{"in", " ", "a", " ", "separate", " ", "vector", " ", "b_", 
       RowBox[{"{", 
        RowBox[{"i", ",", "g"}], "}"}]}], ";", " ", "so"}], ",", " ", 
     RowBox[{"as", " ", "a", " ", "result"}], ",", " ", 
     RowBox[{
      RowBox[{"each", " ", "B_", 
       RowBox[{"{", "i", "}"}], " ", "with", " ", "g"}], "=", "1"}], ",", "2",
      ",", "...", ",", 
     RowBox[{
      RowBox[{"length", "[", 
       RowBox[{"B_", 
        RowBox[{"{", "i", "}"}]}], "]"}], " ", "elements"}], ",", " ", 
     RowBox[{
      RowBox[{"will", " ", "have", " ", "g"}], "=", "1"}], ",", "2", ",", "...",
      ",", 
     RowBox[{"length", "[", 
      RowBox[{"B_", 
       RowBox[{"{", "i", "}"}]}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{"b_", 
       RowBox[{"{", 
        RowBox[{"i", ",", "g"}], "}"}], " ", "vectors"}], ";", " ", 
      RowBox[{"Then", " ", "after"}]}], ",", " ", 
     RowBox[{
     "forming", " ", "all", " ", "the", " ", "maximum", " ", "independent", 
      " ", "subsets", " ", "of", " ", "each", " ", "\"\<b\>\""}], ",", " ", 
     RowBox[{
     "as", " ", "the", " ", "samples", " ", "of", " ", "the", " ", "random", 
      " ", "variable", " ", "\"\<C\>\"", " ", "in", " ", "the", " ", "chain", 
      " ", "rule", " ", "probability", " ", "formula"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"g", "=", "1"}], ",", 
         RowBox[{"g", "<", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Subscript", "[", 
             RowBox[{"B", ",", "i"}], "]"}], "]"}], "+", "1"}]}], ",", 
         RowBox[{"g", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"b", ",", "i", ",", "g"}], "]"}], "=", 
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"B", ",", "i"}], "]"}], "[", 
            RowBox[{"[", "g", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"cindep", ",", "i", ",", "g"}], "]"}], "=", 
           RowBox[{"Sort", "[", 
            RowBox[{"FindIndependentVertexSet", "[", 
             RowBox[{
              RowBox[{"Subgraph", "[", 
               RowBox[{"W1", ",", 
                RowBox[{"Subscript", "[", 
                 RowBox[{"b", ",", "i", ",", "g"}], "]"}], ",", 
                RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}]}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"Length", "[", 
                RowBox[{
                 RowBox[{"FindIndependentVertexSet", "[", 
                  RowBox[{"Subgraph", "[", 
                   RowBox[{"W1", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "i", ",", "g"}], "]"}]}], "]"}], "]"}], 
                 "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "}"}], ",", "All"}], 
             "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "nested", " ", "\"\<for\>\"", " ", "loop", " ", "saves", 
      " ", "every", " ", "element", " ", "of", " ", "every", " ", 
      RowBox[{"Subscript", "[", 
       RowBox[{"cindep", ",", "i", ",", "g"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "in", " ", "a", " ", "separate", " ", "vector", " ", "onecindep_", 
       RowBox[{"{", 
        RowBox[{"i", ",", "g", ",", "l"}], "}"}]}], ";", " ", "so"}], ",", 
     " ", 
     RowBox[{"as", " ", "a", " ", "result"}], ",", " ", 
     RowBox[{
      RowBox[{"each", " ", 
       RowBox[{"Subscript", "[", 
        RowBox[{"cindep", ",", "i", ",", "g"}], "]"}], " ", "with", " ", 
       "l"}], "=", "1"}], ",", "2", ",", "...", ",", 
     RowBox[{
      RowBox[{"length", "[", 
       RowBox[{"Subscript", "[", 
        RowBox[{"cindep", ",", "i", ",", "g"}], "]"}], "]"}], " ", 
      "elements"}], ",", " ", 
     RowBox[{
      RowBox[{"will", " ", "have", " ", "l"}], "=", "1"}], ",", "2", ",", "...",
      ",", 
     RowBox[{"length", "[", 
      RowBox[{"Subscript", "[", 
       RowBox[{"cindep", ",", "i", ",", "g"}], "]"}], "]"}], ",", " ", 
     RowBox[{"onecindep_", 
      RowBox[{"{", 
       RowBox[{"i", ",", "g", ",", "l"}], "}"}], " ", "vectors"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"g", "=", "1"}], ",", 
         RowBox[{"g", "<", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Subscript", "[", 
             RowBox[{"B", ",", "i"}], "]"}], "]"}], "+", "1"}]}], ",", 
         RowBox[{"g", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"l", "=", "1"}], ",", 
            RowBox[{"l", "<", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Subscript", "[", 
                RowBox[{"cindep", ",", "i", ",", "g"}], "]"}], "]"}], "+", 
              "1"}]}], ",", 
            RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"onecindep", ",", "i", ",", "g", ",", "l"}], "]"}], 
              "=", 
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"cindep", ",", "i", ",", "g"}], "]"}], "[", 
               RowBox[{"[", "l", "]"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"for", " ", "all", " ", "nodes", " ", "in", " ", 
      RowBox[{"Subscript", "[", 
       RowBox[{"rep", ",", "i"}], "]"}]}], ",", " ", 
     RowBox[{
     "we", " ", "form", " ", "the", " ", "corresponding", " ", "subset", " ", 
      "of", " ", "nodes", " ", "in", " ", "\"\<Subscript[a,i,g]\>\"", " ", 
      "that", " ", "all", " ", "access", " ", "that", " ", "particular", " ", 
      "node", " ", "of", " ", 
      RowBox[{"Subscript", "[", 
       RowBox[{"rep", ",", "i"}], "]"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"x", "=", "1"}], ",", 
         RowBox[{"x", "<", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Subscript", "[", 
             RowBox[{"A", ",", "i"}], "]"}], "]"}], "+", "1"}]}], ",", 
         RowBox[{"x", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Subscript", "[", 
                RowBox[{"rep", ",", "i"}], "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"r", "=", "0"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"achild", ",", "i", ",", "x", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Subscript", "[", 
                   RowBox[{"rep", ",", "i"}], "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"0", "*", "z"}], ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", "1", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"a", ",", "i", ",", "x"}], "]"}], "]"}]}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"y", "=", "1"}], ",", 
               RowBox[{"y", "<", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"Subscript", "[", 
                   RowBox[{"a", ",", "i", ",", "x"}], "]"}], "]"}], "+", 
                 "1"}]}], ",", 
               RowBox[{"y", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"a", ",", "i", ",", "x"}], "]"}], "[", 
                    RowBox[{"[", "y", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "i"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ">", 
                   "0"}], ",", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"r", "=", 
                    RowBox[{"r", "+", "1"}]}], ";", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "i", ",", "x", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "i"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "=", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "i", ",", "x", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "i"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"r", "\[Rule]", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"a", ",", "i", ",", "x"}], "]"}], "[", 
                    RowBox[{"[", "y", "]"}], "]"}]}]}], "]"}]}]}], ")"}], ",", 
                  RowBox[{"Unevaluated", "[", 
                   RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"achild", ",", "i", ",", "x", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Subscript", "[", 
                   RowBox[{"rep", ",", "i"}], "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "=", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"achild", ",", "i", ",", "x", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "i"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "0", ",", 
                "Infinity"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"for", " ", "all", " ", "nodes", " ", "in", " ", 
      RowBox[{"Subscript", "[", 
       RowBox[{"req", ",", "i"}], "]"}]}], ",", " ", 
     RowBox[{
     "we", " ", "form", " ", "the", " ", "corresponding", " ", "subset", " ", 
      "of", " ", "nodes", " ", "in", " ", 
      "\"\<Subscript[onecindep,i,g,l]\>\"", " ", "that", " ", "all", " ", 
      "access", " ", "that", " ", "particular", " ", "node", " ", "of", " ", 
      RowBox[{"Subscript", "[", 
       RowBox[{"req", ",", "i"}], "]"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"g", "=", "1"}], ",", 
         RowBox[{"g", "<", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Subscript", "[", 
             RowBox[{"B", ",", "i"}], "]"}], "]"}], "+", "1"}]}], ",", 
         RowBox[{"g", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"l", "=", "1"}], ",", 
            RowBox[{"l", "<", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Subscript", "[", 
                RowBox[{"cindep", ",", "i", ",", "g"}], "]"}], "]"}], "+", 
              "1"}]}], ",", 
            RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", "=", "1"}], ",", 
               RowBox[{"j", "<", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"Subscript", "[", 
                   RowBox[{"req", ",", "i"}], "]"}], "]"}], "+", "1"}]}], ",", 
               RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"r", "=", "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Subscript", "[", 
                  RowBox[{"onecindepchild", ",", "i", ",", "g", ",", "l", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "i"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "=", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"0", "*", "z"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"z", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"onecindep", ",", "i", ",", "g", ",", "l"}], 
                    "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"y", "=", "1"}], ",", 
                  RowBox[{"y", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"onecindep", ",", "i", ",", "g", ",", "l"}], 
                    "]"}], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"y", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"onecindep", ",", "i", ",", "g", ",", "l"}], 
                    "]"}], "[", 
                    RowBox[{"[", "y", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "i"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ">", 
                    "0"}], ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"r", "=", 
                    RowBox[{"r", "+", "1"}]}], ";", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "i", ",", "g", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "i"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "=", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "i", ",", "g", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "i"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"r", "\[Rule]", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"onecindep", ",", "i", ",", "g", ",", "l"}], 
                    "]"}], "[", 
                    RowBox[{"[", "y", "]"}], "]"}]}]}], "]"}]}]}], ")"}], ",", 
                    RowBox[{"Unevaluated", "[", 
                    RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Subscript", "[", 
                  RowBox[{"onecindepchild", ",", "i", ",", "g", ",", "l", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "i"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "=", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "i", ",", "g", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "i"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "0", ",", 
                   "Infinity"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
              "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"for", " ", "each", " ", "\"\<Subscript[b,i,g]\>\""}], ",", " ", 
     
     RowBox[{
     "we", " ", "find", " ", "its", " ", "complement", " ", "regarding", " ", 
      "\"\<Subscript[rep,i]\>\"", " ", "and", " ", "we", " ", "name", " ", 
      "it", " ", "as", " ", "\"\<Subscript[z,i,g]\>\""}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"g", "=", "1"}], ",", 
         RowBox[{"g", "<", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Subscript", "[", 
             RowBox[{"B", ",", "i"}], "]"}], "]"}], "+", "1"}]}], ",", 
         RowBox[{"g", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"b", ",", "i", ",", "g"}], "]"}], "=", 
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"B", ",", "i"}], "]"}], "[", 
            RowBox[{"[", "g", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"z", ",", "i", ",", "g"}], "]"}], "=", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"rep", ",", "i"}], "]"}], ",", 
             RowBox[{"Subscript", "[", 
              RowBox[{"b", ",", "i", ",", "g"}], "]"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n", "*", "k"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}]}], "}"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n", "*", "k"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}]}], "}"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n", "*", "k"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}]}], "}"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q4", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n", "*", "k"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}]}], "}"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q5", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n", "*", "k"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}]}], "}"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q6", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n", "*", "k"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}]}], "}"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"SetAttributes", "[", 
       RowBox[{"findBadSets", ",", "HoldFirst"}], "]"}], 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"findBadSets", "[", "expr_", "]"}]}], ":=", 
     RowBox[{
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Unevaluated", "@", "expr"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Set", "|", "SetDelayed"}], ")"}], "[", 
           RowBox[{
            RowBox[{"bad", ":", 
             RowBox[{"head_Symbol", "[", "___", "]"}]}], ",", "_"}], "]"}], "/;", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Attributes", "@", "head"}], ",", "Protected"}], "]"}]}], 
         "\[RuleDelayed]", 
         RowBox[{"HoldForm", "[", 
          RowBox[{"Row", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"head", ",", "bad"}], "}"}], ",", 
            RowBox[{"Spacer", "[", "30", "]"}]}], "]"}], "]"}]}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "//", "Column"}]}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "the", " ", "following", " ", "boolean", " ", "variable", " ", "is", " ", 
     "needed", " ", "for", " ", "the", " ", "cases", " ", "that", " ", 
     "\"\<q_{nk}\>\"", " ", "is", " ", "not", " ", "logically", " ", 
     "possible"}], " ", "*)"}], "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"assump", "=", "False"}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Psuccess1", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "<", 
          RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
         RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"k", "\[Equal]", "n"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"Q1", ",", "n", ",", "k"}], "]"}], "=", 
               RowBox[{"Product", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], ">", "0"}], ",", 
                   RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}]}], ",", 
                   RowBox[{"Unevaluated", "[", 
                    RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "2", ",", "M"}], "}"}]}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"Q1", ",", "n", ",", "k"}], "]"}], "=", 
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                   RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"g", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                "+", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}]}], ",", "1", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", "*", " ", 
                    
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]], 
                    " ", "*", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"B", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"g", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                 "]"}]}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", "<", "k"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"Q1", ",", "n", ",", "k"}], "]"}], "=", 
               RowBox[{
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "s", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "*", 
                   "Psuccess1"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", "2", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"H", ",", "k"}], "]"}]}], "}"}]}], "]"}], "*", 
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ">", 
                    "0"}], ",", 
                    RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}]}], ",", 
                    RowBox[{"Unevaluated", "[", 
                    RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"d", ",", "1", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"F", ",", "k"}], "]"}]}], "}"}]}], "]"}]}]}], ",",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"e", "=", "2"}], ",", 
                 RowBox[{"e", "<", 
                  RowBox[{"M", "+", "1"}]}], ",", 
                 RowBox[{"e", "++"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"statesArray2", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "[", 
                    RowBox[{"[", "e", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"statesArray2", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", "e", "]"}], "]"}], "\[Equal]", "0"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"assump", "=", "True"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"assump", "\[Equal]", "True"}], ",", 
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{"Q1", ",", "n", ",", "k"}], "]"}], "=", "0"}], ",", 
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{"Q1", ",", "n", ",", "k"}], "]"}], "=", 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}]}], ",", "1", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "*", " ", 
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]], 
                    " ", "*", "\[IndentingNewLine]", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"v", ",", "n", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"v", ",", "n", ",", "k"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"v", ",", "n", ",", "k"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}]}], ",", "1", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"compv", ",", "n", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"compv", ",", "n", ",", "k"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"B", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"g", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                   "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"assump", "=", "False"}], ";"}]}], " ", 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Defining", " ", "vector", " ", "t", " ", "of", " ", "the", " ", 
      RowBox[{"chain", ":", " ", 
       RowBox[{"absorbtion", " ", "from", " ", "every", " ", "state"}]}]}], 
     ";", " ", 
     RowBox[{
     "note", " ", "that", " ", "in", " ", "this", " ", "example", " ", 
      "there", " ", "are", " ", "\"\<bin - 2\>\"", " ", "transient", " ", 
      "states"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}]}], "}"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[NotEqual]", "1"}], ",", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"t1", ",", "n"}], "]"}], "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 FractionBox["1", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                 RowBox[{"Product", "[", 
                  RowBox[{
                   RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}]}], ",", "1", ",", 
                   RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "*", " ", 
                 FractionBox["1", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]], 
                 " ", "*", "\[IndentingNewLine]", 
                 RowBox[{"Product", "[", 
                  RowBox[{
                   RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                  "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "1", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"c", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"Subscript", "[", 
                  RowBox[{"B", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"g", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"Subscript", "[", 
                RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
         ",", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"t1", ",", "n"}], "]"}], "=", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"W", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "i"}], "]"}], "]"}], "*", 
             RowBox[{"(", "Psuccess1", ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "M"}], "}"}]}], "]"}]}]}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Defining", " ", "the", " ", "initial", " ", "state", " ", 
       "probability", " ", 
       RowBox[{"vector", ":", " ", 
        RowBox[{
        "we", " ", "can", " ", "get", " ", "such", " ", "probabilities", " ", 
         "from", " ", "the", " ", "first", " ", "phase", " ", "of", " ", 
         "operation"}]}]}], ";", " ", 
      RowBox[{
      "note", " ", "that", " ", "in", " ", "this", " ", "example", " ", 
       "script", " ", "we", " ", "have", " ", "in", " ", "total", " ", 
       "\"\<bin-1\>\"", " ", "states", " ", 
       RowBox[{"(", 
        RowBox[{"including", " ", "absorption", " ", "state"}], ")"}]}]}], 
     ",", " ", 
     RowBox[{
     "as", " ", "one", " ", "of", " ", "them", " ", "was", " ", "not", " ", 
      "topologically", " ", "feasible", " ", "to", " ", "happen", " ", "and", 
      " ", "hense", " ", "removed", " ", "from", " ", "the", " ", "list", " ",
       "of", " ", "the", " ", "system", " ", "states"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{"Length", "[", "statesArray2", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"test", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"for", " ", "all", " ", "the", " ", "states"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{
        RowBox[{"Length", "[", "statesArray2", "]"}], "+", "1"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"test", "=", 
        RowBox[{
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"1", "-", 
            RowBox[{"P1", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"req", ",", "n"}], "]"}], "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "10"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"Subscript", "[", 
               RowBox[{"req", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], "*", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"P1", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"rep", ",", "n"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "10"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "2", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"Subscript", "[", 
               RowBox[{"rep", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"v1", ",", "n"}], "]"}], "=", "test"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"compensate1", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"compensate1", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"v1", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "statesArray2", "]"}]}], "}"}]}], "]"}]}], 
       ")"}], "/", 
      RowBox[{"Length", "[", "statesArray2", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{
        RowBox[{"Length", "[", "statesArray2", "]"}], "+", "1"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"test", "=", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"v1", ",", "n"}], "]"}], "+", "compensate1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"v1", ",", "n"}], "]"}], "=", "test"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"absorption", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"absorption", "=", 
     RowBox[{"Part", "[", 
      RowBox[{"v1", ",", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "generate", " ", "the", " ", "initial", " ", "distribution", " ", 
      "vector", " ", "v"}], ",", " ", 
     RowBox[{
     "without", " ", "the", " ", "last", " ", "element", " ", "which", " ", 
      "is", " ", "the", " ", "probability", " ", "of", " ", "being", " ", 
      "in", " ", "the", " ", "absorbing", " ", "state", " ", "of", " ", "the",
       " ", 
      RowBox[{"system", ".", " ", "we"}], " ", "will", " ", "use", " ", 
      "this", " ", "vector", " ", "to", " ", "generate", " ", "PMFs"}]}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v1", "=", 
     RowBox[{"Drop", "[", 
      RowBox[{"v1", ",", 
       RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "PMF", " ", "of", " ", "the", " ", "number", " ", "of", " ", "steps", " ",
      "till", " ", 
     RowBox[{"absrobtion", ":", " ", 
      RowBox[{"gives", " ", "PMF", " ", "of", " ", "the", " ", "delay"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stepsPMF1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"v1", ".", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"x", "\[NotEqual]", "0"}], ",", 
          RowBox[{"MatrixPower", "[", 
           RowBox[{"Q1", ",", "x"}], "]"}], ",", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{
            RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}], "]"}]}],
          "]"}], ".", "t1"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "CDF", " ", "of", " ", "the", " ", "number", " ", "of", " ", "steps", " ",
      "till", " ", 
     RowBox[{"absrobtion", ":", " ", 
      RowBox[{"gives", " ", "CDF", " ", "of", " ", "the", " ", "delay"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stepsCDF1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"stepsPMF1", ",", "n"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "k"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Storing", " ", "PMF", " ", "of", " ", "the", " ", "number", " ", "of", 
     " ", "steps", " ", "to", " ", "global", " ", "matrices"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray1", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{"Part", "[", 
         RowBox[{"stepsPMF1", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray1", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<PMF of steps till absorption: \>\"", ",", 
       RowBox[{"TableForm", "[", "singlePMFArray", "]"}]}], "]"}], ";"}], " ",
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Storing", " ", "CDF", " ", "of", " ", "the", " ", "number", " ", "of", 
     " ", "steps", " ", "to", " ", "global", " ", "matrices"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray1", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{"Part", "[", 
         RowBox[{"stepsCDF1", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray1", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<CDF of steps till absorption: \>\"", ",", 
       RowBox[{"TableForm", "[", "singleCDFArray", "]"}]}], "]"}], ";"}], " ",
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "to", " ", "check", " ", "if", " ", "the", " ", "retransmission", " ", 
     "steps", " ", "are", " ", "sufficient", " ", "and", " ", "that", " ", 
     "is", " ", "proven", " ", "if", " ", "the", " ", "sum", " ", "of", " ", 
     "the", " ", "\"\<Part[v,Length[statesArray2]]\>\"", " ", "and", " ", 
     "initial", " ", "\"\<Part[singleCDFArray5,2,1]\>\"", " ", "is", " ", 
     "\"\<1\>\""}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<initial CDF +  Part[v,Length[statesArray2]] is : \>\"", ",", " ", 
      RowBox[{
       RowBox[{"Part", "[", 
        RowBox[{"singleCDFArray1", ",", "2", ",", "30"}], "]"}], "+", 
       "absorption"}]}], "]"}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "we", " ", "need", " ", "to", " ", "compensate", " ", "for", " ", "the", 
      " ", "lacking", " ", "of", " ", "the", " ", "absorption", " ", 
      "probability", " ", "in", " ", "PMFs", " ", "and", " ", "CDF"}], ",", 
     " ", 
     RowBox[{"and", " ", "then", " ", "recalculate", " ", "PMFs"}], ",", " ", 
     
     RowBox[{"as", " ", "follows"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray1", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{"Part", "[", 
         RowBox[{"stepsPMF1", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray1", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray1", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"stepsCDF1", ",", "n"}], "]"}], "+", "absorption"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray1", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "the", " ", "following", " ", "boolean", " ", "variable", " ", "is", " ", 
     "needed", " ", "for", " ", "the", " ", "cases", " ", "that", " ", 
     "\"\<q_{nk}\>\"", " ", "is", " ", "not", " ", "logically", " ", 
     "possible"}], " ", "*)"}], "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"assump", "=", "False"}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Psuccess2", "=", "0.6"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "<", 
          RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
         RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"k", "\[Equal]", "n"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"Q2", ",", "n", ",", "k"}], "]"}], "=", 
               RowBox[{"Product", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], ">", "0"}], ",", 
                   RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}]}], ",", 
                   RowBox[{"Unevaluated", "[", 
                    RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "2", ",", "M"}], "}"}]}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"Q2", ",", "n", ",", "k"}], "]"}], "=", 
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                   RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"g", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                "+", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}]}], ",", "1", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", "*", " ", 
                    
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]], 
                    " ", "*", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"B", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"g", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                 "]"}]}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", "<", "k"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"Q2", ",", "n", ",", "k"}], "]"}], "=", 
               RowBox[{
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "s", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "*", 
                   "Psuccess2"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", "2", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"H", ",", "k"}], "]"}]}], "}"}]}], "]"}], "*", 
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ">", 
                    "0"}], ",", 
                    RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}]}], ",", 
                    RowBox[{"Unevaluated", "[", 
                    RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"d", ",", "1", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"F", ",", "k"}], "]"}]}], "}"}]}], "]"}]}]}], ",",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"e", "=", "2"}], ",", 
                 RowBox[{"e", "<", 
                  RowBox[{"M", "+", "1"}]}], ",", 
                 RowBox[{"e", "++"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"statesArray2", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "[", 
                    RowBox[{"[", "e", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"statesArray2", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", "e", "]"}], "]"}], "\[Equal]", "0"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"assump", "=", "True"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"assump", "\[Equal]", "True"}], ",", 
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{"Q2", ",", "n", ",", "k"}], "]"}], "=", "0"}], ",", 
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{"Q2", ",", "n", ",", "k"}], "]"}], "=", 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}]}], ",", "1", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "*", " ", 
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]], 
                    " ", "*", "\[IndentingNewLine]", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"v", ",", "n", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"v", ",", "n", ",", "k"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"v", ",", "n", ",", "k"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}]}], ",", "1", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"compv", ",", "n", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"compv", ",", "n", ",", "k"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"B", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"g", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                   "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"assump", "=", "False"}], ";"}]}], " ", 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Defining", " ", "vector", " ", "t", " ", "of", " ", "the", " ", 
      RowBox[{"chain", ":", " ", 
       RowBox[{"absorbtion", " ", "from", " ", "every", " ", "state"}]}]}], 
     ";", " ", 
     RowBox[{
     "note", " ", "that", " ", "in", " ", "this", " ", "example", " ", 
      "there", " ", "are", " ", "\"\<bin - 2\>\"", " ", "transient", " ", 
      "states"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}]}], "}"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[NotEqual]", "1"}], ",", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"t2", ",", "n"}], "]"}], "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 FractionBox["1", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                 RowBox[{"Product", "[", 
                  RowBox[{
                   RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}]}], ",", "1", ",", 
                   RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "*", " ", 
                 FractionBox["1", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]], 
                 " ", "*", "\[IndentingNewLine]", 
                 RowBox[{"Product", "[", 
                  RowBox[{
                   RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                  "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "1", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"c", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"Subscript", "[", 
                  RowBox[{"B", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"g", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"Subscript", "[", 
                RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
         ",", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"t2", ",", "n"}], "]"}], "=", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"W", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "i"}], "]"}], "]"}], "*", 
             RowBox[{"(", "Psuccess2", ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "M"}], "}"}]}], "]"}]}]}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Defining", " ", "the", " ", "initial", " ", "state", " ", 
       "probability", " ", 
       RowBox[{"vector", ":", " ", 
        RowBox[{
        "we", " ", "can", " ", "get", " ", "such", " ", "probabilities", " ", 
         "from", " ", "the", " ", "first", " ", "phase", " ", "of", " ", 
         "operation"}]}]}], ";", " ", 
      RowBox[{
      "note", " ", "that", " ", "in", " ", "this", " ", "example", " ", 
       "script", " ", "we", " ", "have", " ", "in", " ", "total", " ", 
       "\"\<bin-1\>\"", " ", "states", " ", 
       RowBox[{"(", 
        RowBox[{"including", " ", "absorption", " ", "state"}], ")"}]}]}], 
     ",", " ", 
     RowBox[{
     "as", " ", "one", " ", "of", " ", "them", " ", "was", " ", "not", " ", 
      "topologically", " ", "feasible", " ", "to", " ", "happen", " ", "and", 
      " ", "hense", " ", "removed", " ", "from", " ", "the", " ", "list", " ",
       "of", " ", "the", " ", "system", " ", "states"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{"Length", "[", "statesArray2", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"test", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"for", " ", "all", " ", "the", " ", "states"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{
        RowBox[{"Length", "[", "statesArray2", "]"}], "+", "1"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"test", "=", 
        RowBox[{
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"1", "-", 
            RowBox[{"P2", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"req", ",", "n"}], "]"}], "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "10"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"Subscript", "[", 
               RowBox[{"req", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], "*", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"P2", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"rep", ",", "n"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "10"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "2", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"Subscript", "[", 
               RowBox[{"rep", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"v2", ",", "n"}], "]"}], "=", "test"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"compensate1", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"compensate1", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"v2", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "statesArray2", "]"}]}], "}"}]}], "]"}]}], 
       ")"}], "/", 
      RowBox[{"Length", "[", "statesArray2", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{
        RowBox[{"Length", "[", "statesArray2", "]"}], "+", "1"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"test", "=", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"v2", ",", "n"}], "]"}], "+", "compensate1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"v2", ",", "n"}], "]"}], "=", "test"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"absorption", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"absorption", "=", 
     RowBox[{"Part", "[", 
      RowBox[{"v2", ",", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "generate", " ", "the", " ", "initial", " ", "distribution", " ", 
      "vector", " ", "v"}], ",", " ", 
     RowBox[{
     "without", " ", "the", " ", "last", " ", "element", " ", "which", " ", 
      "is", " ", "the", " ", "probability", " ", "of", " ", "being", " ", 
      "in", " ", "the", " ", "absorbing", " ", "state", " ", "of", " ", "the",
       " ", 
      RowBox[{"system", ".", " ", "we"}], " ", "will", " ", "use", " ", 
      "this", " ", "vector", " ", "to", " ", "generate", " ", "PMFs"}]}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v2", "=", 
     RowBox[{"Drop", "[", 
      RowBox[{"v2", ",", 
       RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "PMF", " ", "of", " ", "the", " ", "number", " ", "of", " ", "steps", " ",
      "till", " ", 
     RowBox[{"absrobtion", ":", " ", 
      RowBox[{"gives", " ", "PMF", " ", "of", " ", "the", " ", "delay"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stepsPMF2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"v2", ".", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"x", "\[NotEqual]", "0"}], ",", 
          RowBox[{"MatrixPower", "[", 
           RowBox[{"Q2", ",", "x"}], "]"}], ",", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{
            RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}], "]"}]}],
          "]"}], ".", "t2"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "CDF", " ", "of", " ", "the", " ", "number", " ", "of", " ", "steps", " ",
      "till", " ", 
     RowBox[{"absrobtion", ":", " ", 
      RowBox[{"gives", " ", "CDF", " ", "of", " ", "the", " ", "delay"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stepsCDF2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"stepsPMF2", ",", "n"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "k"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Storing", " ", "PMF", " ", "of", " ", "the", " ", "number", " ", "of", 
     " ", "steps", " ", "to", " ", "global", " ", "matrices"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray2", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{"Part", "[", 
         RowBox[{"stepsPMF2", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray2", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<PMF of steps till absorption: \>\"", ",", 
       RowBox[{"TableForm", "[", "singlePMFArray", "]"}]}], "]"}], ";"}], " ",
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Storing", " ", "CDF", " ", "of", " ", "the", " ", "number", " ", "of", 
     " ", "steps", " ", "to", " ", "global", " ", "matrices"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray2", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{"Part", "[", 
         RowBox[{"stepsCDF2", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray2", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<CDF of steps till absorption: \>\"", ",", 
       RowBox[{"TableForm", "[", "singleCDFArray", "]"}]}], "]"}], ";"}], " ",
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "to", " ", "check", " ", "if", " ", "the", " ", "retransmission", " ", 
     "steps", " ", "are", " ", "sufficient", " ", "and", " ", "that", " ", 
     "is", " ", "proven", " ", "if", " ", "the", " ", "sum", " ", "of", " ", 
     "the", " ", "\"\<Part[v,Length[statesArray2]]\>\"", " ", "and", " ", 
     "initial", " ", "\"\<Part[singleCDFArray5,2,1]\>\"", " ", "is", " ", 
     "\"\<1\>\""}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<initial CDF +  Part[v,Length[statesArray2]] is : \>\"", ",", " ", 
      RowBox[{
       RowBox[{"Part", "[", 
        RowBox[{"singleCDFArray2", ",", "2", ",", "30"}], "]"}], "+", 
       "absorption"}]}], "]"}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "we", " ", "need", " ", "to", " ", "compensate", " ", "for", " ", "the", 
      " ", "lacking", " ", "of", " ", "the", " ", "absorption", " ", 
      "probability", " ", "in", " ", "PMFs", " ", "and", " ", "CDF"}], ",", 
     " ", 
     RowBox[{"and", " ", "then", " ", "recalculate", " ", "PMFs"}], ",", " ", 
     
     RowBox[{"as", " ", "follows"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray2", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{"Part", "[", 
         RowBox[{"stepsPMF2", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray2", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray2", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"stepsCDF2", ",", "n"}], "]"}], "+", "absorption"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray2", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "the", " ", "following", " ", "boolean", " ", "variable", " ", "is", " ", 
     "needed", " ", "for", " ", "the", " ", "cases", " ", "that", " ", 
     "\"\<q_{nk}\>\"", " ", "is", " ", "not", " ", "logically", " ", 
     "possible"}], " ", "*)"}], "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"assump", "=", "False"}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Psuccess3", "=", "0.7"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "<", 
          RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
         RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"k", "\[Equal]", "n"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"Q3", ",", "n", ",", "k"}], "]"}], "=", 
               RowBox[{"Product", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], ">", "0"}], ",", 
                   RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}]}], ",", 
                   RowBox[{"Unevaluated", "[", 
                    RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "2", ",", "M"}], "}"}]}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"Q3", ",", "n", ",", "k"}], "]"}], "=", 
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                   RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"g", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                "+", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}]}], ",", "1", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", "*", " ", 
                    
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]], 
                    " ", "*", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"B", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"g", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                 "]"}]}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", "<", "k"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"Q3", ",", "n", ",", "k"}], "]"}], "=", 
               RowBox[{
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "s", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "*", 
                   "Psuccess3"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", "2", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"H", ",", "k"}], "]"}]}], "}"}]}], "]"}], "*", 
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ">", 
                    "0"}], ",", 
                    RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}]}], ",", 
                    RowBox[{"Unevaluated", "[", 
                    RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"d", ",", "1", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"F", ",", "k"}], "]"}]}], "}"}]}], "]"}]}]}], ",",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"e", "=", "2"}], ",", 
                 RowBox[{"e", "<", 
                  RowBox[{"M", "+", "1"}]}], ",", 
                 RowBox[{"e", "++"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"statesArray2", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "[", 
                    RowBox[{"[", "e", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"statesArray2", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", "e", "]"}], "]"}], "\[Equal]", "0"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"assump", "=", "True"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"assump", "\[Equal]", "True"}], ",", 
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{"Q3", ",", "n", ",", "k"}], "]"}], "=", "0"}], ",", 
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{"Q3", ",", "n", ",", "k"}], "]"}], "=", 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}]}], ",", "1", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "*", " ", 
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]], 
                    " ", "*", "\[IndentingNewLine]", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"v", ",", "n", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"v", ",", "n", ",", "k"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"v", ",", "n", ",", "k"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}]}], ",", "1", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"compv", ",", "n", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"compv", ",", "n", ",", "k"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"B", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"g", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                   "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"assump", "=", "False"}], ";"}]}], " ", 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Defining", " ", "vector", " ", "t", " ", "of", " ", "the", " ", 
      RowBox[{"chain", ":", " ", 
       RowBox[{"absorbtion", " ", "from", " ", "every", " ", "state"}]}]}], 
     ";", " ", 
     RowBox[{
     "note", " ", "that", " ", "in", " ", "this", " ", "example", " ", 
      "there", " ", "are", " ", "\"\<bin - 2\>\"", " ", "transient", " ", 
      "states"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}]}], "}"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[NotEqual]", "1"}], ",", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"t3", ",", "n"}], "]"}], "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 FractionBox["1", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                 RowBox[{"Product", "[", 
                  RowBox[{
                   RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}]}], ",", "1", ",", 
                   RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "*", " ", 
                 FractionBox["1", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]], 
                 " ", "*", "\[IndentingNewLine]", 
                 RowBox[{"Product", "[", 
                  RowBox[{
                   RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                  "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "1", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"c", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"Subscript", "[", 
                  RowBox[{"B", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"g", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"Subscript", "[", 
                RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
         ",", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"t3", ",", "n"}], "]"}], "=", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"W", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "i"}], "]"}], "]"}], "*", 
             RowBox[{"(", "Psuccess3", ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "M"}], "}"}]}], "]"}]}]}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Defining", " ", "the", " ", "initial", " ", "state", " ", 
       "probability", " ", 
       RowBox[{"vector", ":", " ", 
        RowBox[{
        "we", " ", "can", " ", "get", " ", "such", " ", "probabilities", " ", 
         "from", " ", "the", " ", "first", " ", "phase", " ", "of", " ", 
         "operation"}]}]}], ";", " ", 
      RowBox[{
      "note", " ", "that", " ", "in", " ", "this", " ", "example", " ", 
       "script", " ", "we", " ", "have", " ", "in", " ", "total", " ", 
       "\"\<bin-1\>\"", " ", "states", " ", 
       RowBox[{"(", 
        RowBox[{"including", " ", "absorption", " ", "state"}], ")"}]}]}], 
     ",", " ", 
     RowBox[{
     "as", " ", "one", " ", "of", " ", "them", " ", "was", " ", "not", " ", 
      "topologically", " ", "feasible", " ", "to", " ", "happen", " ", "and", 
      " ", "hense", " ", "removed", " ", "from", " ", "the", " ", "list", " ",
       "of", " ", "the", " ", "system", " ", "states"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{"Length", "[", "statesArray2", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"test", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"for", " ", "all", " ", "the", " ", "states"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{
        RowBox[{"Length", "[", "statesArray2", "]"}], "+", "1"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"test", "=", 
        RowBox[{
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"1", "-", 
            RowBox[{"P3", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"req", ",", "n"}], "]"}], "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "10"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"Subscript", "[", 
               RowBox[{"req", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], "*", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"P3", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"rep", ",", "n"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "10"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "2", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"Subscript", "[", 
               RowBox[{"rep", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"v3", ",", "n"}], "]"}], "=", "test"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"compensate1", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"compensate1", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"v3", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "statesArray2", "]"}]}], "}"}]}], "]"}]}], 
       ")"}], "/", 
      RowBox[{"Length", "[", "statesArray2", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{
        RowBox[{"Length", "[", "statesArray2", "]"}], "+", "1"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"test", "=", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"v3", ",", "n"}], "]"}], "+", "compensate1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"v3", ",", "n"}], "]"}], "=", "test"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"absorption", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"absorption", "=", 
     RowBox[{"Part", "[", 
      RowBox[{"v3", ",", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "generate", " ", "the", " ", "initial", " ", "distribution", " ", 
      "vector", " ", "v"}], ",", " ", 
     RowBox[{
     "without", " ", "the", " ", "last", " ", "element", " ", "which", " ", 
      "is", " ", "the", " ", "probability", " ", "of", " ", "being", " ", 
      "in", " ", "the", " ", "absorbing", " ", "state", " ", "of", " ", "the",
       " ", 
      RowBox[{"system", ".", " ", "we"}], " ", "will", " ", "use", " ", 
      "this", " ", "vector", " ", "to", " ", "generate", " ", "PMFs"}]}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v3", "=", 
     RowBox[{"Drop", "[", 
      RowBox[{"v3", ",", 
       RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "PMF", " ", "of", " ", "the", " ", "number", " ", "of", " ", "steps", " ",
      "till", " ", 
     RowBox[{"absrobtion", ":", " ", 
      RowBox[{"gives", " ", "PMF", " ", "of", " ", "the", " ", "delay"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stepsPMF3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"v3", ".", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"x", "\[NotEqual]", "0"}], ",", 
          RowBox[{"MatrixPower", "[", 
           RowBox[{"Q3", ",", "x"}], "]"}], ",", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{
            RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}], "]"}]}],
          "]"}], ".", "t3"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "CDF", " ", "of", " ", "the", " ", "number", " ", "of", " ", "steps", " ",
      "till", " ", 
     RowBox[{"absrobtion", ":", " ", 
      RowBox[{"gives", " ", "CDF", " ", "of", " ", "the", " ", "delay"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stepsCDF3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"stepsPMF3", ",", "n"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "k"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Storing", " ", "PMF", " ", "of", " ", "the", " ", "number", " ", "of", 
     " ", "steps", " ", "to", " ", "global", " ", "matrices"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray3", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{"Part", "[", 
         RowBox[{"stepsPMF3", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray3", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<PMF of steps till absorption: \>\"", ",", 
       RowBox[{"TableForm", "[", "singlePMFArray", "]"}]}], "]"}], ";"}], " ",
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Storing", " ", "CDF", " ", "of", " ", "the", " ", "number", " ", "of", 
     " ", "steps", " ", "to", " ", "global", " ", "matrices"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray3", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{"Part", "[", 
         RowBox[{"stepsCDF3", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray3", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<CDF of steps till absorption: \>\"", ",", 
       RowBox[{"TableForm", "[", "singleCDFArray", "]"}]}], "]"}], ";"}], " ",
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "to", " ", "check", " ", "if", " ", "the", " ", "retransmission", " ", 
     "steps", " ", "are", " ", "sufficient", " ", "and", " ", "that", " ", 
     "is", " ", "proven", " ", "if", " ", "the", " ", "sum", " ", "of", " ", 
     "the", " ", "\"\<Part[v,Length[statesArray2]]\>\"", " ", "and", " ", 
     "initial", " ", "\"\<Part[singleCDFArray5,2,1]\>\"", " ", "is", " ", 
     "\"\<1\>\""}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<doneee\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<initial CDF +  Part[v,Length[statesArray2]] is : \>\"", ",", " ", 
      RowBox[{
       RowBox[{"Part", "[", 
        RowBox[{"singleCDFArray3", ",", "2", ",", "30"}], "]"}], "+", 
       "absorption"}]}], "]"}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "we", " ", "need", " ", "to", " ", "compensate", " ", "for", " ", "the", 
      " ", "lacking", " ", "of", " ", "the", " ", "absorption", " ", 
      "probability", " ", "in", " ", "PMFs", " ", "and", " ", "CDF"}], ",", 
     " ", 
     RowBox[{"and", " ", "then", " ", "recalculate", " ", "PMFs"}], ",", " ", 
     
     RowBox[{"as", " ", "follows"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray3", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{"Part", "[", 
         RowBox[{"stepsPMF3", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray3", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray3", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"stepsCDF3", ",", "n"}], "]"}], "+", "absorption"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray3", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"assump", "=", "False"}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Psuccess1", "=", "0.8"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "<", 
          RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
         RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"k", "\[Equal]", "n"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"Q4", ",", "n", ",", "k"}], "]"}], "=", 
               RowBox[{"Product", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], ">", "0"}], ",", 
                   RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}]}], ",", 
                   RowBox[{"Unevaluated", "[", 
                    RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "2", ",", "M"}], "}"}]}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"Q4", ",", "n", ",", "k"}], "]"}], "=", 
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                   RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"g", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                "+", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}]}], ",", "1", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", "*", " ", 
                    
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]], 
                    " ", "*", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"B", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"g", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                 "]"}]}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", "<", "k"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"Q4", ",", "n", ",", "k"}], "]"}], "=", 
               RowBox[{
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "s", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "*", 
                   "Psuccess1"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", "2", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"H", ",", "k"}], "]"}]}], "}"}]}], "]"}], "*", 
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ">", 
                    "0"}], ",", 
                    RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}]}], ",", 
                    RowBox[{"Unevaluated", "[", 
                    RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"d", ",", "1", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"F", ",", "k"}], "]"}]}], "}"}]}], "]"}]}]}], ",",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"e", "=", "2"}], ",", 
                 RowBox[{"e", "<", 
                  RowBox[{"M", "+", "1"}]}], ",", 
                 RowBox[{"e", "++"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"statesArray2", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "[", 
                    RowBox[{"[", "e", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"statesArray2", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", "e", "]"}], "]"}], "\[Equal]", "0"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"assump", "=", "True"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"assump", "\[Equal]", "True"}], ",", 
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{"Q4", ",", "n", ",", "k"}], "]"}], "=", "0"}], ",", 
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{"Q4", ",", "n", ",", "k"}], "]"}], "=", 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}]}], ",", "1", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "*", " ", 
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]], 
                    " ", "*", "\[IndentingNewLine]", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"v", ",", "n", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"v", ",", "n", ",", "k"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"v", ",", "n", ",", "k"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}]}], ",", "1", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"compv", ",", "n", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"compv", ",", "n", ",", "k"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"B", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"g", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                   "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"assump", "=", "False"}], ";"}]}], " ", 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Defining", " ", "vector", " ", "t", " ", "of", " ", "the", " ", 
      RowBox[{"chain", ":", " ", 
       RowBox[{"absorbtion", " ", "from", " ", "every", " ", "state"}]}]}], 
     ";", " ", 
     RowBox[{
     "note", " ", "that", " ", "in", " ", "this", " ", "example", " ", 
      "there", " ", "are", " ", "\"\<bin - 2\>\"", " ", "transient", " ", 
      "states"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t4", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}]}], "}"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[NotEqual]", "1"}], ",", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"t4", ",", "n"}], "]"}], "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 FractionBox["1", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                 RowBox[{"Product", "[", 
                  RowBox[{
                   RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}]}], ",", "1", ",", 
                   RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "*", " ", 
                 FractionBox["1", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]], 
                 " ", "*", "\[IndentingNewLine]", 
                 RowBox[{"Product", "[", 
                  RowBox[{
                   RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess1"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                  "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "1", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"c", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"Subscript", "[", 
                  RowBox[{"B", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"g", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"Subscript", "[", 
                RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
         ",", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"t4", ",", "n"}], "]"}], "=", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"W", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "i"}], "]"}], "]"}], "*", 
             RowBox[{"(", "Psuccess1", ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "M"}], "}"}]}], "]"}]}]}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Defining", " ", "the", " ", "initial", " ", "state", " ", 
       "probability", " ", 
       RowBox[{"vector", ":", " ", 
        RowBox[{
        "we", " ", "can", " ", "get", " ", "such", " ", "probabilities", " ", 
         "from", " ", "the", " ", "first", " ", "phase", " ", "of", " ", 
         "operation"}]}]}], ";", " ", 
      RowBox[{
      "note", " ", "that", " ", "in", " ", "this", " ", "example", " ", 
       "script", " ", "we", " ", "have", " ", "in", " ", "total", " ", 
       "\"\<bin-1\>\"", " ", "states", " ", 
       RowBox[{"(", 
        RowBox[{"including", " ", "absorption", " ", "state"}], ")"}]}]}], 
     ",", " ", 
     RowBox[{
     "as", " ", "one", " ", "of", " ", "them", " ", "was", " ", "not", " ", 
      "topologically", " ", "feasible", " ", "to", " ", "happen", " ", "and", 
      " ", "hense", " ", "removed", " ", "from", " ", "the", " ", "list", " ",
       "of", " ", "the", " ", "system", " ", "states"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v4", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{"Length", "[", "statesArray2", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"test", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"for", " ", "all", " ", "the", " ", "states"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{
        RowBox[{"Length", "[", "statesArray2", "]"}], "+", "1"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"test", "=", 
        RowBox[{
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"1", "-", 
            RowBox[{"P4", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"req", ",", "n"}], "]"}], "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "10"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"Subscript", "[", 
               RowBox[{"req", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], "*", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"P4", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"rep", ",", "n"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "10"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "2", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"Subscript", "[", 
               RowBox[{"rep", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"v4", ",", "n"}], "]"}], "=", "test"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"compensate1", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"compensate1", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"v4", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "statesArray2", "]"}]}], "}"}]}], "]"}]}], 
       ")"}], "/", 
      RowBox[{"Length", "[", "statesArray2", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{
        RowBox[{"Length", "[", "statesArray2", "]"}], "+", "1"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"test", "=", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"v4", ",", "n"}], "]"}], "+", "compensate1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"v4", ",", "n"}], "]"}], "=", "test"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"absorption", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"absorption", "=", 
     RowBox[{"Part", "[", 
      RowBox[{"v4", ",", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "generate", " ", "the", " ", "initial", " ", "distribution", " ", 
      "vector", " ", "v"}], ",", " ", 
     RowBox[{
     "without", " ", "the", " ", "last", " ", "element", " ", "which", " ", 
      "is", " ", "the", " ", "probability", " ", "of", " ", "being", " ", 
      "in", " ", "the", " ", "absorbing", " ", "state", " ", "of", " ", "the",
       " ", 
      RowBox[{"system", ".", " ", "we"}], " ", "will", " ", "use", " ", 
      "this", " ", "vector", " ", "to", " ", "generate", " ", "PMFs"}]}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v4", "=", 
     RowBox[{"Drop", "[", 
      RowBox[{"v4", ",", 
       RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "PMF", " ", "of", " ", "the", " ", "number", " ", "of", " ", "steps", " ",
      "till", " ", 
     RowBox[{"absrobtion", ":", " ", 
      RowBox[{"gives", " ", "PMF", " ", "of", " ", "the", " ", "delay"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stepsPMF1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"v4", ".", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"x", "\[NotEqual]", "0"}], ",", 
          RowBox[{"MatrixPower", "[", 
           RowBox[{"Q4", ",", "x"}], "]"}], ",", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{
            RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}], "]"}]}],
          "]"}], ".", "t4"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "CDF", " ", "of", " ", "the", " ", "number", " ", "of", " ", "steps", " ",
      "till", " ", 
     RowBox[{"absrobtion", ":", " ", 
      RowBox[{"gives", " ", "CDF", " ", "of", " ", "the", " ", "delay"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stepsCDF1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"stepsPMF1", ",", "n"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "k"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Storing", " ", "PMF", " ", "of", " ", "the", " ", "number", " ", "of", 
     " ", "steps", " ", "to", " ", "global", " ", "matrices"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray4", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{"Part", "[", 
         RowBox[{"stepsPMF1", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray4", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<PMF of steps till absorption: \>\"", ",", 
       RowBox[{"TableForm", "[", "singlePMFArray", "]"}]}], "]"}], ";"}], " ",
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Storing", " ", "CDF", " ", "of", " ", "the", " ", "number", " ", "of", 
     " ", "steps", " ", "to", " ", "global", " ", "matrices"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray4", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{"Part", "[", 
         RowBox[{"stepsCDF1", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray4", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<CDF of steps till absorption: \>\"", ",", 
       RowBox[{"TableForm", "[", "singleCDFArray", "]"}]}], "]"}], ";"}], " ",
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "to", " ", "check", " ", "if", " ", "the", " ", "retransmission", " ", 
     "steps", " ", "are", " ", "sufficient", " ", "and", " ", "that", " ", 
     "is", " ", "proven", " ", "if", " ", "the", " ", "sum", " ", "of", " ", 
     "the", " ", "\"\<Part[v,Length[statesArray2]]\>\"", " ", "and", " ", 
     "initial", " ", "\"\<Part[singleCDFArray5,2,1]\>\"", " ", "is", " ", 
     "\"\<1\>\""}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<initial CDF +  Part[v,Length[statesArray2]] is : \>\"", ",", " ", 
      RowBox[{
       RowBox[{"Part", "[", 
        RowBox[{"singleCDFArray4", ",", "2", ",", "30"}], "]"}], "+", 
       "absorption"}]}], "]"}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "we", " ", "need", " ", "to", " ", "compensate", " ", "for", " ", "the", 
      " ", "lacking", " ", "of", " ", "the", " ", "absorption", " ", 
      "probability", " ", "in", " ", "PMFs", " ", "and", " ", "CDF"}], ",", 
     " ", 
     RowBox[{"and", " ", "then", " ", "recalculate", " ", "PMFs"}], ",", " ", 
     
     RowBox[{"as", " ", "follows"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray4", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{"Part", "[", 
         RowBox[{"stepsPMF1", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray4", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray4", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"stepsCDF1", ",", "n"}], "]"}], "+", "absorption"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray4", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "the", " ", "following", " ", "boolean", " ", "variable", " ", "is", " ", 
     "needed", " ", "for", " ", "the", " ", "cases", " ", "that", " ", 
     "\"\<q_{nk}\>\"", " ", "is", " ", "not", " ", "logically", " ", 
     "possible"}], " ", "*)"}], "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"assump", "=", "False"}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Psuccess2", "=", "0.9"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "<", 
          RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
         RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"k", "\[Equal]", "n"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"Q5", ",", "n", ",", "k"}], "]"}], "=", 
               RowBox[{"Product", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], ">", "0"}], ",", 
                   RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}]}], ",", 
                   RowBox[{"Unevaluated", "[", 
                    RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "2", ",", "M"}], "}"}]}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"Q5", ",", "n", ",", "k"}], "]"}], "=", 
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                   RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"g", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                "+", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}]}], ",", "1", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", "*", " ", 
                    
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]], 
                    " ", "*", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"B", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"g", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                 "]"}]}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", "<", "k"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"Q5", ",", "n", ",", "k"}], "]"}], "=", 
               RowBox[{
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "s", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "*", 
                   "Psuccess2"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", "2", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"H", ",", "k"}], "]"}]}], "}"}]}], "]"}], "*", 
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ">", 
                    "0"}], ",", 
                    RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}]}], ",", 
                    RowBox[{"Unevaluated", "[", 
                    RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"d", ",", "1", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"F", ",", "k"}], "]"}]}], "}"}]}], "]"}]}]}], ",",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"e", "=", "2"}], ",", 
                 RowBox[{"e", "<", 
                  RowBox[{"M", "+", "1"}]}], ",", 
                 RowBox[{"e", "++"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"statesArray2", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "[", 
                    RowBox[{"[", "e", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"statesArray2", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", "e", "]"}], "]"}], "\[Equal]", "0"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"assump", "=", "True"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"assump", "\[Equal]", "True"}], ",", 
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{"Q5", ",", "n", ",", "k"}], "]"}], "=", "0"}], ",", 
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{"Q5", ",", "n", ",", "k"}], "]"}], "=", 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}]}], ",", "1", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "*", " ", 
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]], 
                    " ", "*", "\[IndentingNewLine]", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"v", ",", "n", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"v", ",", "n", ",", "k"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"v", ",", "n", ",", "k"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}]}], ",", "1", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"compv", ",", "n", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"compv", ",", "n", ",", "k"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"B", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"g", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                   "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"assump", "=", "False"}], ";"}]}], " ", 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Defining", " ", "vector", " ", "t", " ", "of", " ", "the", " ", 
      RowBox[{"chain", ":", " ", 
       RowBox[{"absorbtion", " ", "from", " ", "every", " ", "state"}]}]}], 
     ";", " ", 
     RowBox[{
     "note", " ", "that", " ", "in", " ", "this", " ", "example", " ", 
      "there", " ", "are", " ", "\"\<bin - 2\>\"", " ", "transient", " ", 
      "states"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t5", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}]}], "}"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[NotEqual]", "1"}], ",", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"t5", ",", "n"}], "]"}], "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 FractionBox["1", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                 RowBox[{"Product", "[", 
                  RowBox[{
                   RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}]}], ",", "1", ",", 
                   RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "*", " ", 
                 FractionBox["1", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]], 
                 " ", "*", "\[IndentingNewLine]", 
                 RowBox[{"Product", "[", 
                  RowBox[{
                   RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess2"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                  "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "1", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"c", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"Subscript", "[", 
                  RowBox[{"B", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"g", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"Subscript", "[", 
                RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
         ",", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"t5", ",", "n"}], "]"}], "=", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"W", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "i"}], "]"}], "]"}], "*", 
             RowBox[{"(", "Psuccess2", ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "M"}], "}"}]}], "]"}]}]}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Defining", " ", "the", " ", "initial", " ", "state", " ", 
       "probability", " ", 
       RowBox[{"vector", ":", " ", 
        RowBox[{
        "we", " ", "can", " ", "get", " ", "such", " ", "probabilities", " ", 
         "from", " ", "the", " ", "first", " ", "phase", " ", "of", " ", 
         "operation"}]}]}], ";", " ", 
      RowBox[{
      "note", " ", "that", " ", "in", " ", "this", " ", "example", " ", 
       "script", " ", "we", " ", "have", " ", "in", " ", "total", " ", 
       "\"\<bin-1\>\"", " ", "states", " ", 
       RowBox[{"(", 
        RowBox[{"including", " ", "absorption", " ", "state"}], ")"}]}]}], 
     ",", " ", 
     RowBox[{
     "as", " ", "one", " ", "of", " ", "them", " ", "was", " ", "not", " ", 
      "topologically", " ", "feasible", " ", "to", " ", "happen", " ", "and", 
      " ", "hense", " ", "removed", " ", "from", " ", "the", " ", "list", " ",
       "of", " ", "the", " ", "system", " ", "states"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v5", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{"Length", "[", "statesArray2", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"test", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"for", " ", "all", " ", "the", " ", "states"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{
        RowBox[{"Length", "[", "statesArray2", "]"}], "+", "1"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"test", "=", 
        RowBox[{
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"1", "-", 
            RowBox[{"P5", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"req", ",", "n"}], "]"}], "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "10"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"Subscript", "[", 
               RowBox[{"req", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], "*", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"P5", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"rep", ",", "n"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "10"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "2", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"Subscript", "[", 
               RowBox[{"rep", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"v5", ",", "n"}], "]"}], "=", "test"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"compensate1", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"compensate1", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"v5", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "statesArray2", "]"}]}], "}"}]}], "]"}]}], 
       ")"}], "/", 
      RowBox[{"Length", "[", "statesArray2", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{
        RowBox[{"Length", "[", "statesArray2", "]"}], "+", "1"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"test", "=", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"v5", ",", "n"}], "]"}], "+", "compensate1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"v5", ",", "n"}], "]"}], "=", "test"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"absorption", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"absorption", "=", 
     RowBox[{"Part", "[", 
      RowBox[{"v5", ",", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "generate", " ", "the", " ", "initial", " ", "distribution", " ", 
      "vector", " ", "v"}], ",", " ", 
     RowBox[{
     "without", " ", "the", " ", "last", " ", "element", " ", "which", " ", 
      "is", " ", "the", " ", "probability", " ", "of", " ", "being", " ", 
      "in", " ", "the", " ", "absorbing", " ", "state", " ", "of", " ", "the",
       " ", 
      RowBox[{"system", ".", " ", "we"}], " ", "will", " ", "use", " ", 
      "this", " ", "vector", " ", "to", " ", "generate", " ", "PMFs"}]}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v5", "=", 
     RowBox[{"Drop", "[", 
      RowBox[{"v5", ",", 
       RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "PMF", " ", "of", " ", "the", " ", "number", " ", "of", " ", "steps", " ",
      "till", " ", 
     RowBox[{"absrobtion", ":", " ", 
      RowBox[{"gives", " ", "PMF", " ", "of", " ", "the", " ", "delay"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stepsPMF2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"v5", ".", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"x", "\[NotEqual]", "0"}], ",", 
          RowBox[{"MatrixPower", "[", 
           RowBox[{"Q5", ",", "x"}], "]"}], ",", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{
            RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}], "]"}]}],
          "]"}], ".", "t5"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "CDF", " ", "of", " ", "the", " ", "number", " ", "of", " ", "steps", " ",
      "till", " ", 
     RowBox[{"absrobtion", ":", " ", 
      RowBox[{"gives", " ", "CDF", " ", "of", " ", "the", " ", "delay"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stepsCDF2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"stepsPMF2", ",", "n"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "k"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Storing", " ", "PMF", " ", "of", " ", "the", " ", "number", " ", "of", 
     " ", "steps", " ", "to", " ", "global", " ", "matrices"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray5", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{"Part", "[", 
         RowBox[{"stepsPMF2", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray5", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<PMF of steps till absorption: \>\"", ",", 
       RowBox[{"TableForm", "[", "singlePMFArray", "]"}]}], "]"}], ";"}], " ",
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Storing", " ", "CDF", " ", "of", " ", "the", " ", "number", " ", "of", 
     " ", "steps", " ", "to", " ", "global", " ", "matrices"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray5", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{"Part", "[", 
         RowBox[{"stepsCDF2", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray5", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<CDF of steps till absorption: \>\"", ",", 
       RowBox[{"TableForm", "[", "singleCDFArray", "]"}]}], "]"}], ";"}], " ",
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "to", " ", "check", " ", "if", " ", "the", " ", "retransmission", " ", 
     "steps", " ", "are", " ", "sufficient", " ", "and", " ", "that", " ", 
     "is", " ", "proven", " ", "if", " ", "the", " ", "sum", " ", "of", " ", 
     "the", " ", "\"\<Part[v,Length[statesArray2]]\>\"", " ", "and", " ", 
     "initial", " ", "\"\<Part[singleCDFArray5,2,1]\>\"", " ", "is", " ", 
     "\"\<1\>\""}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<initial CDF +  Part[v,Length[statesArray2]] is : \>\"", ",", " ", 
      RowBox[{
       RowBox[{"Part", "[", 
        RowBox[{"singleCDFArray5", ",", "2", ",", "30"}], "]"}], "+", 
       "absorption"}]}], "]"}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "we", " ", "need", " ", "to", " ", "compensate", " ", "for", " ", "the", 
      " ", "lacking", " ", "of", " ", "the", " ", "absorption", " ", 
      "probability", " ", "in", " ", "PMFs", " ", "and", " ", "CDF"}], ",", 
     " ", 
     RowBox[{"and", " ", "then", " ", "recalculate", " ", "PMFs"}], ",", " ", 
     
     RowBox[{"as", " ", "follows"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray5", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{"Part", "[", 
         RowBox[{"stepsPMF2", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray5", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray5", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"stepsCDF2", ",", "n"}], "]"}], "+", "absorption"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray5", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "the", " ", "following", " ", "boolean", " ", "variable", " ", "is", " ", 
     "needed", " ", "for", " ", "the", " ", "cases", " ", "that", " ", 
     "\"\<q_{nk}\>\"", " ", "is", " ", "not", " ", "logically", " ", 
     "possible"}], " ", "*)"}], "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"assump", "=", "False"}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Psuccess3", "=", "0.98"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "<", 
          RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
         RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"k", "\[Equal]", "n"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"Q6", ",", "n", ",", "k"}], "]"}], "=", 
               RowBox[{"Product", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], ">", "0"}], ",", 
                   RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}]}], ",", 
                   RowBox[{"Unevaluated", "[", 
                    RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "2", ",", "M"}], "}"}]}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"Q6", ",", "n", ",", "k"}], "]"}], "=", 
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                   RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"g", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                "+", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}]}], ",", "1", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", "*", " ", 
                    
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]], 
                    " ", "*", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"B", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"g", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                 "]"}]}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", "<", "k"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"Q6", ",", "n", ",", "k"}], "]"}], "=", 
               RowBox[{
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "s", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "*", 
                   "Psuccess3"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", "2", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"H", ",", "k"}], "]"}]}], "}"}]}], "]"}], "*", 
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ">", 
                    "0"}], ",", 
                    RowBox[{
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}]}], ",", 
                    RowBox[{"Unevaluated", "[", 
                    RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"d", ",", "1", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"F", ",", "k"}], "]"}]}], "}"}]}], "]"}]}]}], ",",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"e", "=", "2"}], ",", 
                 RowBox[{"e", "<", 
                  RowBox[{"M", "+", "1"}]}], ",", 
                 RowBox[{"e", "++"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"statesArray2", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "[", 
                    RowBox[{"[", "e", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"statesArray2", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", "e", "]"}], "]"}], "\[Equal]", "0"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"assump", "=", "True"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"assump", "\[Equal]", "True"}], ",", 
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{"Q6", ",", "n", ",", "k"}], "]"}], "=", "0"}], ",", 
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{"Q6", ",", "n", ",", "k"}], "]"}], "=", 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}]}], ",", "1", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "*", " ", 
                    FractionBox["1", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]], 
                    " ", "*", "\[IndentingNewLine]", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"v", ",", "n", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"v", ",", "n", ",", "k"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"v", ",", "n", ",", "k"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}]}], ",", "1", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"compv", ",", "n", ",", "k"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"compv", ",", "n", ",", "k"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"B", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"g", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                   "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"assump", "=", "False"}], ";"}]}], " ", 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Defining", " ", "vector", " ", "t", " ", "of", " ", "the", " ", 
      RowBox[{"chain", ":", " ", 
       RowBox[{"absorbtion", " ", "from", " ", "every", " ", "state"}]}]}], 
     ";", " ", 
     RowBox[{
     "note", " ", "that", " ", "in", " ", "this", " ", "example", " ", 
      "there", " ", "are", " ", "\"\<bin - 2\>\"", " ", "transient", " ", 
      "states"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t6", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}]}], "}"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[NotEqual]", "1"}], ",", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"t6", ",", "n"}], "]"}], "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 FractionBox["1", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"A", ",", "n"}], "]"}], "]"}]], "*", 
                 RowBox[{"Product", "[", 
                  RowBox[{
                   RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "*", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"b", ",", "n", ",", "c"}], "]"}], "==", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"rep", ",", "n"}], "]"}]}], ",", "1", ",", 
                   RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"achild", ",", "n", ",", "g", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"z", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "*", " ", 
                 FractionBox["1", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]], 
                 " ", "*", "\[IndentingNewLine]", 
                 RowBox[{"Product", "[", 
                  RowBox[{
                   RowBox[{"1", "-", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Psuccess3"}], ")"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    "onecindepchild", ",", "n", ",", "c", ",", "l", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"req", ",", "n"}], "]"}], "]"}]}], "}"}]}], 
                  "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "1", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"cindep", ",", "n", ",", "c"}], "]"}], "]"}]}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"c", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"Subscript", "[", 
                  RowBox[{"B", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"g", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"Subscript", "[", 
                RowBox[{"A", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
         ",", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"t6", ",", "n"}], "]"}], "=", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"W", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "i"}], "]"}], "]"}], "*", 
             RowBox[{"(", "Psuccess3", ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "M"}], "}"}]}], "]"}]}]}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Defining", " ", "the", " ", "initial", " ", "state", " ", 
       "probability", " ", 
       RowBox[{"vector", ":", " ", 
        RowBox[{
        "we", " ", "can", " ", "get", " ", "such", " ", "probabilities", " ", 
         "from", " ", "the", " ", "first", " ", "phase", " ", "of", " ", 
         "operation"}]}]}], ";", " ", 
      RowBox[{
      "note", " ", "that", " ", "in", " ", "this", " ", "example", " ", 
       "script", " ", "we", " ", "have", " ", "in", " ", "total", " ", 
       "\"\<bin-1\>\"", " ", "states", " ", 
       RowBox[{"(", 
        RowBox[{"including", " ", "absorption", " ", "state"}], ")"}]}]}], 
     ",", " ", 
     RowBox[{
     "as", " ", "one", " ", "of", " ", "them", " ", "was", " ", "not", " ", 
      "topologically", " ", "feasible", " ", "to", " ", "happen", " ", "and", 
      " ", "hense", " ", "removed", " ", "from", " ", "the", " ", "list", " ",
       "of", " ", "the", " ", "system", " ", "states"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v6", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"0", "*", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{"Length", "[", "statesArray2", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"test", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"for", " ", "all", " ", "the", " ", "states"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{
        RowBox[{"Length", "[", "statesArray2", "]"}], "+", "1"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"test", "=", 
        RowBox[{
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"1", "-", 
            RowBox[{"P6", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"req", ",", "n"}], "]"}], "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "10"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"Subscript", "[", 
               RowBox[{"req", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}], "*", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"P6", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"rep", ",", "n"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "10"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "2", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"Subscript", "[", 
               RowBox[{"rep", ",", "n"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"v6", ",", "n"}], "]"}], "=", "test"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"compensate1", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"compensate1", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"v6", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "statesArray2", "]"}]}], "}"}]}], "]"}]}], 
       ")"}], "/", 
      RowBox[{"Length", "[", "statesArray2", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", 
       RowBox[{
        RowBox[{"Length", "[", "statesArray2", "]"}], "+", "1"}]}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"test", "=", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"v6", ",", "n"}], "]"}], "+", "compensate1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"v6", ",", "n"}], "]"}], "=", "test"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"absorption", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"absorption", "=", 
     RowBox[{"Part", "[", 
      RowBox[{"v6", ",", 
       RowBox[{"Length", "[", "statesArray2", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "generate", " ", "the", " ", "initial", " ", "distribution", " ", 
      "vector", " ", "v"}], ",", " ", 
     RowBox[{
     "without", " ", "the", " ", "last", " ", "element", " ", "which", " ", 
      "is", " ", "the", " ", "probability", " ", "of", " ", "being", " ", 
      "in", " ", "the", " ", "absorbing", " ", "state", " ", "of", " ", "the",
       " ", 
      RowBox[{"system", ".", " ", "we"}], " ", "will", " ", "use", " ", 
      "this", " ", "vector", " ", "to", " ", "generate", " ", "PMFs"}]}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v6", "=", 
     RowBox[{"Drop", "[", 
      RowBox[{"v6", ",", 
       RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "PMF", " ", "of", " ", "the", " ", "number", " ", "of", " ", "steps", " ",
      "till", " ", 
     RowBox[{"absrobtion", ":", " ", 
      RowBox[{"gives", " ", "PMF", " ", "of", " ", "the", " ", "delay"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stepsPMF3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"v6", ".", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"x", "\[NotEqual]", "0"}], ",", 
          RowBox[{"MatrixPower", "[", 
           RowBox[{"Q6", ",", "x"}], "]"}], ",", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{
            RowBox[{"Length", "[", "statesArray2", "]"}], "-", "1"}], "]"}]}],
          "]"}], ".", "t6"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "CDF", " ", "of", " ", "the", " ", "number", " ", "of", " ", "steps", " ",
      "till", " ", 
     RowBox[{"absrobtion", ":", " ", 
      RowBox[{"gives", " ", "CDF", " ", "of", " ", "the", " ", "delay"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stepsCDF3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"stepsPMF3", ",", "n"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "k"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Storing", " ", "PMF", " ", "of", " ", "the", " ", "number", " ", "of", 
     " ", "steps", " ", "to", " ", "global", " ", "matrices"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray6", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{"Part", "[", 
         RowBox[{"stepsPMF3", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray6", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<PMF of steps till absorption: \>\"", ",", 
       RowBox[{"TableForm", "[", "singlePMFArray", "]"}]}], "]"}], ";"}], " ",
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Storing", " ", "CDF", " ", "of", " ", "the", " ", "number", " ", "of", 
     " ", "steps", " ", "to", " ", "global", " ", "matrices"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray6", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{"Part", "[", 
         RowBox[{"stepsCDF3", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray6", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<CDF of steps till absorption: \>\"", ",", 
       RowBox[{"TableForm", "[", "singleCDFArray", "]"}]}], "]"}], ";"}], " ",
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "to", " ", "check", " ", "if", " ", "the", " ", "retransmission", " ", 
     "steps", " ", "are", " ", "sufficient", " ", "and", " ", "that", " ", 
     "is", " ", "proven", " ", "if", " ", "the", " ", "sum", " ", "of", " ", 
     "the", " ", "\"\<Part[v,Length[statesArray2]]\>\"", " ", "and", " ", 
     "initial", " ", "\"\<Part[singleCDFArray5,2,1]\>\"", " ", "is", " ", 
     "\"\<1\>\""}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<doneee\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<initial CDF +  Part[v,Length[statesArray2]] is : \>\"", ",", " ", 
      RowBox[{
       RowBox[{"Part", "[", 
        RowBox[{"singleCDFArray6", ",", "2", ",", "30"}], "]"}], "+", 
       "absorption"}]}], "]"}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "we", " ", "need", " ", "to", " ", "compensate", " ", "for", " ", "the", 
      " ", "lacking", " ", "of", " ", "the", " ", "absorption", " ", 
      "probability", " ", "in", " ", "PMFs", " ", "and", " ", "CDF"}], ",", 
     " ", 
     RowBox[{"and", " ", "then", " ", "recalculate", " ", "PMFs"}], ",", " ", 
     
     RowBox[{"as", " ", "follows"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray6", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{"Part", "[", 
         RowBox[{"stepsPMF3", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray6", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "<", "31"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray6", ",", "2", ",", "n"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"stepsCDF3", ",", "n"}], "]"}], "+", "absorption"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singleCDFArray6", ",", "1", ",", "n"}], "]"}], "=", "n"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "the", " ", "following", " ", "is", " ", "to", " ", "calculate", " ", 
     "the", " ", "average", " ", "overhead", " ", "of", " ", "error", " ", 
     "recovery", " ", "in", " ", "terms", " ", "of", " ", "the", " ", 
     "number", " ", "of", " ", "retransmission", " ", "requests", " ", 
     "needed"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rr25", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray1", ",", "2", ",", "z"}], "]"}], "*", "z"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<rr25 is : \>\"", ",", " ", "rr25"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rr26", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray2", ",", "2", ",", "z"}], "]"}], "*", "z"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<rr26 is : \>\"", ",", " ", "rr26"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rr27", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray3", ",", "2", ",", "z"}], "]"}], "*", "z"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<rr27 is : \>\"", ",", " ", "rr27"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rr28", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray4", ",", "2", ",", "z"}], "]"}], "*", "z"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<rr28 is : \>\"", ",", " ", "rr28"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rr29", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray5", ",", "2", ",", "z"}], "]"}], "*", "z"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<rr29 is : \>\"", ",", " ", "rr29"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rr30", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"singlePMFArray6", ",", "2", ",", "z"}], "]"}], "*", "z"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "1", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<rr30 is : \>\"", ",", " ", "rr30"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<rr25.mx\>\"", ",", "rr25"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<rr26.mx\>\"", ",", "rr26"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<rr27.mx\>\"", ",", "rr27"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<rr28.mx\>\"", ",", "rr28"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<rr29.mx\>\"", ",", "rr29"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<rr30.mx\>\"", ",", "rr30"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6719042613069973`*^9, 3.671904262423119*^9}, {
  3.6719044157083473`*^9, 3.671904416853333*^9}, {3.671904462892632*^9, 
  3.671904531939267*^9}, {3.671905043032302*^9, 3.6719050684800253`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"initial CDF +  Part[v,Length[statesArray2]] is : \"\>", 
   "\[InvisibleSpace]", "0.9971388279021146`"}],
  SequenceForm[
  "initial CDF +  Part[v,Length[statesArray2]] is : ", 0.9971388279021146],
  Editable->False]], "Print",
 CellChangeTimes->{3.6719497143651323`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"initial CDF +  Part[v,Length[statesArray2]] is : \"\>", 
   "\[InvisibleSpace]", "0.9997963053892033`"}],
  SequenceForm[
  "initial CDF +  Part[v,Length[statesArray2]] is : ", 0.9997963053892033],
  Editable->False]], "Print",
 CellChangeTimes->{3.6719497987579193`*^9}],

Cell[BoxData["\<\"doneee\"\>"], "Print",
 CellChangeTimes->{3.6719498901397038`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"initial CDF +  Part[v,Length[statesArray2]] is : \"\>", 
   "\[InvisibleSpace]", "0.9999899591294847`"}],
  SequenceForm[
  "initial CDF +  Part[v,Length[statesArray2]] is : ", 0.9999899591294847],
  Editable->False]], "Print",
 CellChangeTimes->{3.6719498901429462`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"initial CDF +  Part[v,Length[statesArray2]] is : \"\>", 
   "\[InvisibleSpace]", "0.9999997537871819`"}],
  SequenceForm[
  "initial CDF +  Part[v,Length[statesArray2]] is : ", 0.9999997537871819],
  Editable->False]], "Print",
 CellChangeTimes->{3.671949978582799*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"initial CDF +  Part[v,Length[statesArray2]] is : \"\>", 
   "\[InvisibleSpace]", "0.9999999990424213`"}],
  SequenceForm[
  "initial CDF +  Part[v,Length[statesArray2]] is : ", 0.9999999990424213],
  Editable->False]], "Print",
 CellChangeTimes->{3.671950063832118*^9}],

Cell[BoxData["\<\"doneee\"\>"], "Print",
 CellChangeTimes->{3.6719501484178658`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"initial CDF +  Part[v,Length[statesArray2]] is : \"\>", 
   "\[InvisibleSpace]", "0.9999999999999861`"}],
  SequenceForm[
  "initial CDF +  Part[v,Length[statesArray2]] is : ", 0.9999999999999861],
  Editable->False]], "Print",
 CellChangeTimes->{3.6719501484215527`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rr25 is : \"\>", "\[InvisibleSpace]", "4.130929023694062`"}],
  SequenceForm["rr25 is : ", 4.130929023694062],
  Editable->False]], "Print",
 CellChangeTimes->{3.671950148424749*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rr26 is : \"\>", "\[InvisibleSpace]", "2.1457973488630597`"}],
  SequenceForm["rr26 is : ", 2.1457973488630597`],
  Editable->False]], "Print",
 CellChangeTimes->{3.671950148427561*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rr27 is : \"\>", "\[InvisibleSpace]", "1.1039524966049434`"}],
  SequenceForm["rr27 is : ", 1.1039524966049434`],
  Editable->False]], "Print",
 CellChangeTimes->{3.671950148430814*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rr28 is : \"\>", "\[InvisibleSpace]", "0.4834018267584477`"}],
  SequenceForm["rr28 is : ", 0.4834018267584477],
  Editable->False]], "Print",
 CellChangeTimes->{3.671950148433436*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rr29 is : \"\>", "\[InvisibleSpace]", "0.11182677392512329`"}],
  
  SequenceForm["rr29 is : ", 0.11182677392512329`],
  Editable->False]], "Print",
 CellChangeTimes->{3.6719501484361134`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rr30 is : \"\>", "\[InvisibleSpace]", 
   "0.0032588664389858824`"}],
  SequenceForm["rr30 is : ", 0.0032588664389858824`],
  Editable->False]], "Print",
 CellChangeTimes->{3.67195014843876*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1028, 667},
WindowMargins->{{23, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 11, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 337717, 8151, 28347, "Input"],
Cell[CellGroupData[{
Cell[338322, 8177, 320, 7, 22, "Print"],
Cell[338645, 8186, 320, 7, 22, "Print"],
Cell[338968, 8195, 84, 1, 21, "Print"],
Cell[339055, 8198, 320, 7, 22, "Print"],
Cell[339378, 8207, 318, 7, 22, "Print"],
Cell[339699, 8216, 318, 7, 22, "Print"],
Cell[340020, 8225, 84, 1, 21, "Print"],
Cell[340107, 8228, 320, 7, 22, "Print"],
Cell[340430, 8237, 231, 5, 21, "Print"],
Cell[340664, 8244, 234, 5, 21, "Print"],
Cell[340901, 8251, 234, 5, 21, "Print"],
Cell[341138, 8258, 233, 5, 21, "Print"],
Cell[341374, 8265, 241, 6, 21, "Print"],
Cell[341618, 8273, 243, 6, 21, "Print"]
}, Open  ]]
}, Open  ]]
}
]
*)

